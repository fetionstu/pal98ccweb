System.register("chunks:///_virtual/hotelRoom2.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./ShowTalk.ts"],(function(e){"use strict";var o,t,i,n,s,a,h,l,r,c,g,d,m,u,p,C,y,B;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.defineProperty,n=e.assertThisInitialized,s=e.initializerDefineProperty},function(e){a=e.cclegacy,h=e._decorator,l=e.Prefab,r=e.instantiate,c=e.Button,g=e.Collider2D,d=e.Contact2DType,m=e.Animation,u=e.director,p=e.Component},function(e){C=e.Controller},function(e){y=e.GlobalFunc},function(e){B=e.ShowTalk}],execute:function(){var N,f,k,v,R;a._RF.push({},"005d4SK7ChPYKqqaZOrgOQ8","hotelRoom2",void 0);var x=h.ccclass,P=h.property;e("hotelRoom2",(N=x("hotelRoom2"),f=P(l),N((R=o((v=function(e){function o(){for(var o,t=arguments.length,a=new Array(t),h=0;h<t;h++)a[h]=arguments[h];return o=e.call.apply(e,[this].concat(a))||this,i(n(o),"searchRes",[null,null]),i(n(o),"hero",null),i(n(o),"map",null),i(n(o),"talksCount",99),i(n(o),"sceneTalks",[]),s(n(o),"dialogueBox",R,n(o)),o}t(o,e);var a=o.prototype;return a.onLoad=function(){console.log("未读取前进度："+y.ongoing.progress),y.ongoing.readLocal(),console.log("读取后进度："+y.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("maphotelRoom2"),this.layoutGameProgress(),this.setEntryPos(),console.log("hotel所有对话："),console.log(y.sceneTalks);var e=r(this.dialogueBox);this.hero.addChild(e),e.active=!1,console.log(e.name+"加载成功"),console.log("现在对话数="+this.talksCount)},a.start=function(){this.hero.getChildByName("dialogueBox").on(c.EventType.CLICK,this.onNextSpeak,this);var e=this.node.getChildByPath("maphotelRoom2/entry").getComponent(g);e&&e.on(d.BEGIN_CONTACT,this.onEntry,this)},a.onNextSpeak=function(){var e=this;this.hero.getChildByName("dialogueBox").getComponent(c).interactable=!1,this.talksCount<26?(20==this.talksCount&&(this.schedule((function(){y.changeSp(e.hero,"introdish")}),.1),this.node.getChildByPath("maphotelRoom2/dish").active=!0),25==this.talksCount&&(this.hero.getComponent(m).play("takewine"),this.schedule((function(){y.changeSp(e.node.getChildByPath("maphotelRoom2/dish"),"dish2")}),.1),y.ongoing.progress++),console.log("当前第"+this.talksCount+"句，共"+y.sceneTalks.length+"句"),console.log(y.sceneTalks[this.talksCount].msg),B.haveTalks(this.hero.getChildByName("dialogueBox"),y.sceneTalks[this.talksCount]),this.talksCount++):(this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0),this.scheduleOnce((function(){e.hero.getChildByName("dialogueBox").getComponent(c).interactable=!0}),1)},a.layoutGameProgress=function(){var e=this;y.ongoing.progress>2&&y.ongoing.progress<10&&(5==y.ongoing.progress&&(this.talksCount=19),this.node.getChildByName("miao1").active=!0,this.node.getChildByName("miao2").active=!0,this.schedule((function(){y.changeSp(e.node.getChildByName("miao1"),"miao1sl"),y.changeSp(e.node.getChildByName("miao2"),"miao2sd")}),.1))},a.setEntryPos=function(){console.log("进入 "+y.ongoing.nextSceneEntryPos+" 口"),0==y.ongoing.nextSceneEntryPos&&(this.map.setPosition(411,174,0),this.node.getChildByName("miao1").active&&this.node.getChildByName("miao1").setPosition(this.node.getChildByName("miao1").position.x+this.map.position.x,this.node.getChildByName("miao1").position.y+this.map.position.y),this.node.getChildByName("miao2").active&&this.node.getChildByName("miao2").setPosition(this.node.getChildByName("miao2").position.x+this.map.position.x,this.node.getChildByName("miao2").position.y+this.map.position.y))},a.onEntry=function(e,o,t){y.whichEntry("heroLXY",o,e,5,u.getScene().name,"hotel")},a.update=function(e){this.searchRes=this.node.getChildByName("heroLXY").getComponent(C).onGetSearchRes(),null!=this.searchRes[0]&&("miao1"!=this.searchRes[0].collider.node.name&&"miao2"!=this.searchRes[0].collider.node.name||5!=y.ongoing.progress||(this.hero.getChildByName("dialogueBox").active=!0,this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1,B.haveTalks(this.hero.getChildByName("dialogueBox"),y.sceneTalks[this.talksCount]),this.talksCount++),console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&(console.log(this.searchRes[1].node.name),this.searchRes[1]=null)},o}(p)).prototype,"dialogueBox",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=v))||k));a._RF.pop()}}}));

System.register("chunks:///_virtual/Controller.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,o,n,i,s,l,r,h,a,c,g,d,p,m,C,y,u,f,S;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,n=t.defineProperty,i=t.assertThisInitialized,s=t.initializerDefineProperty},function(t){l=t.cclegacy,r=t._decorator,h=t.PhysicsSystem2D,a=t.Input,c=t.Button,g=t.Widget,d=t.find,p=t.Vec2,m=t.UITransform,C=t.Vec3,y=t.ERaycast2DType,u=t.Animation,f=t.Label,S=t.Component}],execute:function(){var v,T,H;l._RF.push({},"023a030GlhG76642FJpRE2A","Controller",void 0);var N=r.ccclass,B=r.property;t("Controller",N("Controller")((H=e((T=function(t){function e(){for(var e,o=arguments.length,l=new Array(o),r=0;r<o;r++)l[r]=arguments[r];return e=t.call.apply(t,[this].concat(l))||this,n(i(e),"ctrller",null),n(i(e),"searchHand",null),n(i(e),"searchRes",[null,null]),n(i(e),"phy",h.instance),n(i(e),"deltaTimeCount",0),n(i(e),"ctrllerState",""),n(i(e),"dirX",-1),n(i(e),"dirY",-1),s(i(e),"heroSpeed",H,i(e)),e}o(e,t);var l=e.prototype;return l.start=function(){this.ctrller=this.node.getChildByName("ctrller"),console.log(this.ctrller.name+"挂载成功"),this.searchHand=this.node.getChildByName("hand"),console.log(this.searchHand.name+"挂载成功"),this.ctrller.getChildByName("ctrllerD").on(a.EventType.TOUCH_START,this.onWalkDown,this),this.ctrller.getChildByName("ctrllerD").on(a.EventType.TOUCH_END,this.onStop,this),this.ctrller.getChildByName("ctrllerL").on(a.EventType.TOUCH_START,this.onWalkLeft,this),this.ctrller.getChildByName("ctrllerL").on(a.EventType.TOUCH_END,this.onStop,this),this.ctrller.getChildByName("ctrllerU").on(a.EventType.TOUCH_START,this.onWalkUp,this),this.ctrller.getChildByName("ctrllerU").on(a.EventType.TOUCH_END,this.onStop,this),this.ctrller.getChildByName("ctrllerR").on(a.EventType.TOUCH_START,this.onWalkRight,this),this.ctrller.getChildByName("ctrllerR").on(a.EventType.TOUCH_END,this.onStop,this),this.searchHand.on(c.EventType.CLICK,this.onSearchSth,this)},l.onLayoutCtrllerNHand=function(){this.ctrller.addComponent(g).target=d("Canvas"),this.ctrller.getComponent(g).isAlignLeft=!0,this.ctrller.getComponent(g).isAlignBottom=!0,this.ctrller.getComponent(g).left=80,this.ctrller.getComponent(g).bottom=30,this.searchHand.addComponent(g).target=d("Canvas"),this.searchHand.getComponent(g).isAlignRight=!0,this.searchHand.getComponent(g).isAlignBottom=!0,this.searchHand.getComponent(g).right=80,this.searchHand.getComponent(g).bottom=50,console.log("摇杆等模块已对齐到"+d("Canvas").name)},l.onSearchSth=function(){var t=this;this.searchHand.getComponent(c).interactable=!1,console.log("正在搜索("+this.dirX+","+this.dirY+")方向");this.node.getPosition();var e=new p(this.node.position.x,this.node.position.y-20),o=(this.node.getWorldPosition(),this.node.getComponent(m).convertToWorldSpaceAR(new C(0,-20,0))),n=(new p(e.x+64*this.dirX,e.y+32*this.dirY),new C(o.x+64*this.dirX,o.y+32*this.dirY,0)),i=this.phy.raycast(o,n,y.Any);console.log("发出一条射线，得到"+i.length+"个物体！"),i.length?(this.searchRes[0]=i[0],console.log("搜索到："+i[0].collider.node.name),console.log("射线交点："+i[0].point)):console.log("没搜索到物体！");var s=this.phy.testPoint(new p(o.x,o.y));s.forEach((function(e){e.node!=t.node?(t.searchRes[1]=e,console.log("在"+e.node.name+"中"),console.log("group："+e.group+"--\x3etag："+e.tag)):1==s.length&&e.node==t.node&&console.log("没在任何物体范围内")})),console.log(this.searchRes[0]+"?=有东西吗=?"+this.searchRes[1]),this.scheduleOnce((function(){t.searchHand.getComponent(c).interactable=!0}),1)},l.onGetSearchRes=function(){return this.searchRes},l.onWalkDown=function(){console.log("向下走"),this.ctrllerState="down",this.dirX=-1,this.dirY=-1,this.getComponent(u).play("downLXY")},l.onStop=function(){console.log("停止走动"),console.log("本地坐标->("+Math.floor(this.node.getPosition().x)+","+Math.floor(this.node.getPosition().y)+")"),console.log("世界坐标->("+Math.floor(this.node.getWorldPosition().x)+","+Math.floor(this.node.getWorldPosition().y)+")"),this.ctrllerState="";var t=null;if(this.getComponent(u).getState("downLXY").isPlaying)t=this.getComponent(u).getState("downLXY");else if(this.getComponent(u).getState("leftLXY").isPlaying)t=this.getComponent(u).getState("leftLXY");else if(this.getComponent(u).getState("upLXY").isPlaying)t=this.getComponent(u).getState("upLXY");else{if(!this.getComponent(u).getState("rightLXY").isPlaying)return console.log(this.getComponent(u).name+" 将停止"),void this.getComponent(u).stop();t=this.getComponent(u).getState("rightLXY")}console.log(t.name+" 将停止"),t.time=2,t.sample(),t.stop()},l.onWalkLeft=function(){console.log("向左走"),this.ctrllerState="left",this.dirX=-1,this.dirY=1,this.getComponent(u).play("leftLXY")},l.onWalkUp=function(){console.log("向上走"),this.ctrllerState="up",this.dirX=1,this.dirY=1,this.getComponent(u).play("upLXY")},l.onWalkRight=function(){console.log("向右走"),this.ctrllerState="right",this.dirX=1,this.dirY=-1,this.getComponent(u).play("rightLXY")},l.onOpenMenu=function(){this.node.getChildByName("lcmoney").active=!0,this.node.getChildByName("settings").active=!0,this.node.getChildByName("exit").active=!0,this.ctrller.active=!1,this.searchHand.active=!1},l.onFlashHint=function(t){var e=this;this.node.getChildByName("hint").getComponent(f).string=t,this.node.getChildByName("hint").active=!0,this.schedule((function(){e.node.getChildByName("hint").active=!1}),1)},l.update=function(t){if(this.deltaTimeCount+=Math.floor(100*t),this.ctrllerState){var e=this.node.getPosition().x+=8*this.dirX*this.heroSpeed,o=this.node.getPosition().y+=4*this.dirY*this.heroSpeed;this.node.setPosition(new C(e,o))}null!=this.node.parent.getChildByName("Camera")&&this.node.parent.getChildByName("Camera").setPosition(this.node.position.x,this.node.position.y,1e3)},e}(S)).prototype,"heroSpeed",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=T))||v);l._RF.pop()}}}));

System.register("chunks:///_virtual/ShowTalk.ts",["cc"],(function(t){"use strict";var e,a,n,o,h,i;return{setters:[function(t){e=t.cclegacy,a=t._decorator,n=t.Label,o=t.resources,h=t.SpriteFrame,i=t.Sprite}],execute:function(){var s;e._RF.push({},"0a0f7/ePaJH4qLcUkXfAWk2","ShowTalk",void 0);var g=a.ccclass;a.property,t("ShowTalk",g("ShowTalk")(s=function(){function t(){}return t.selfTalk=function(t,e){this.showOneByOne(t.getChildByPath("downBox/downSpeak").getComponent(n),e)},t.haveTalks=function(t,e){1==e.pos?(t.getChildByPath("upBox/upSpeak").getComponent(n).unscheduleAllCallbacks(),t.getChildByName("downBox").active=!1,t.getChildByName("upBox").active=!0,t.getChildByPath("upBox/upName").getComponent(n).string!=e.name+":"&&(this.showAvatar(t.getChildByPath("upBox/upAvatar"),e.name),t.getChildByPath("upBox/upName").getComponent(n).string=e.name+":"),this.showOneByOne(t.getChildByPath("upBox/upSpeak").getComponent(n),e.msg)):(t.getChildByPath("downBox/downSpeak").getComponent(n).unscheduleAllCallbacks(),t.getChildByName("upBox").active=!1,t.getChildByName("downBox").active=!0,t.getChildByPath("downBox/downName").getComponent(n).string!=e.name+":"&&(this.showAvatar(t.getChildByPath("downBox/downAvatar"),e.name),t.getChildByPath("downBox/downName").getComponent(n).string=e.name+":"),this.showOneByOne(t.getChildByPath("downBox/downSpeak").getComponent(n),e.msg))},t.showOneByOne=function(t,e){var a=0;t.string="",t.schedule((function(){t.string+=e[a],a++}),.02,e.length-1,.2)},t.showAvatar=function(t,e){"李大娘"==e?this.changeAvatar(t,"LiDaniang"):"李逍遥"==e?this.changeAvatar(t,"LiXiaoyao"):"苗人头领"==e?this.changeAvatar(t,"MiaoChief"):"醉道士"==e?this.changeAvatar(t,"Tao"):"秀兰"==e?this.changeAvatar(t,"Xiu"):"香兰"==e?this.changeAvatar(t,"Xiang"):"张四"==e?this.changeAvatar(t,"ZhangSi"):"王小虎"==e?this.changeAvatar(t,"WangXiaohu"):this.changeAvatar(t,"")},t.changeAvatar=function(t,e){""!=e?o.load("talkAvatar/"+e+"/spriteFrame",h,(function(e,a){t.getComponent(i).spriteFrame=a})):t.getComponent(i).spriteFrame=null},t}())||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyControl.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./GlobalFunc.ts"],(function(o){"use strict";var t,i,e,n,s,r,h,a,l,c,p;return{setters:[function(o){t=o.inheritsLoose,i=o.defineProperty,e=o.assertThisInitialized},function(o){n=o.cclegacy,s=o._decorator,r=o.PolygonCollider2D,h=o.Contact2DType,a=o.CircleCollider2D,l=o.director,c=o.Component},function(o){p=o.GlobalFunc}],execute:function(){var d;n._RF.push({},"0b221+Uqu9L7K2/ubsAcv/B","EnemyControl",void 0);var u=s.ccclass;s.property,o("EnemyControl",u("EnemyControl")(d=function(o){function n(){for(var t,n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return t=o.call.apply(o,[this].concat(s))||this,i(e(t),"hero",null),i(e(t),"dirX",0),i(e(t),"dirY",0),i(e(t),"ratio",0),i(e(t),"ratiox",0),i(e(t),"ratioy",0),i(e(t),"enemySpeed",1.5),i(e(t),"heroInSight",!1),i(e(t),"seekDistance",0),i(e(t),"preHeroPos",null),t}t(n,o);var s=n.prototype;return s.start=function(){this.hero=this.node.parent.parent.getChildByName("heroLXY");var o=this.node.getComponent(r);o&&o.on(h.BEGIN_CONTACT,this.onBattle,this);var t=this.node.getComponent(a);t&&t.on(h.BEGIN_CONTACT,this.onSeekHero,this)},s.onBattle=function(o,t,i){t.node==this.hero&&(console.log("碰到敌人，开始战斗！"),p.ongoing.lastPos=this.hero.position,console.log(p.ongoing.lastPos),p.ongoing.lastScene=l.getScene().name,-1==p.ongoing.killedEnemies.indexOf(o.node.name)&&p.ongoing.killedEnemies.push(o.node.name),p.ongoing.saveLocal(),l.loadScene("battlefield"))},s.onSeekHero=function(o,t,i){t.node==this.hero&&(this.heroInSight=!0,console.log(o.node.name+"发现hero"))},s.onFollowHero=function(){null!=this.preHeroPos&&this.preHeroPos.x==this.hero.position.x&&this.preHeroPos.y==this.hero.position.y||(console.log("调整移动方向"),this.ratiox=this.hero.position.x-this.node.position.x,this.ratioy=this.hero.position.y-70-this.node.position.y,this.ratio=this.enemySpeed/100,this.preHeroPos=this.hero.position.clone()),this.hero.position.x-this.node.position.x>0?this.dirX=1:this.dirX=-1,this.hero.position.y-70-this.node.position.y>0?this.dirY=1:this.dirY=-1,this.node.setPosition(this.node.position.x+Math.abs(this.ratiox)*this.dirX*this.ratio,this.node.position.y+Math.abs(this.ratioy)*this.dirY*this.ratio),this.seekDistance=this.onSeekDistance()},s.onSeekDistance=function(){var o=this.hero.position.x-this.node.position.x,t=this.hero.position.y-70-this.node.position.y;return Math.sqrt(o*o+t*t)},s.update=function(o){this.heroInSight&&(this.onFollowHero(),this.seekDistance>364&&(this.heroInSight=!1))},n}(c))||d);n._RF.pop()}}}));

System.register("chunks:///_virtual/dialtype.ts",["cc"],(function(){"use strict";var t,c;return{setters:[function(e){t=e.cclegacy,c=e._decorator}],execute:function(){t._RF.push({},"1b80dnalupMGp/V4pbn8JZI","dialtype",void 0);c.ccclass,c.property;t._RF.pop()}}}));

System.register("chunks:///_virtual/hotelRoom3.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./ShowTalk.ts"],(function(e){"use strict";var t,o,n,s,i,l,a,h,r,c,g,u,d,p,y,C,m,B;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.defineProperty,s=e.assertThisInitialized,i=e.initializerDefineProperty},function(e){l=e.cclegacy,a=e._decorator,h=e.Prefab,r=e.TiledMap,c=e.director,g=e.instantiate,u=e.Button,d=e.Collider2D,p=e.Contact2DType,y=e.Component},function(e){C=e.Controller},function(e){m=e.GlobalFunc},function(e){B=e.ShowTalk}],execute:function(){var k,v,f,N,R;l._RF.push({},"20b03eV+rhMNIRTSzcGZQ4A","hotelRoom3",void 0);var x=a.ccclass,T=a.property;e("hotelRoom3",(k=x("hotelRoom3"),v=T(h),k((R=t((N=function(e){function t(){for(var t,o=arguments.length,l=new Array(o),a=0;a<o;a++)l[a]=arguments[a];return t=e.call.apply(e,[this].concat(l))||this,n(s(t),"searchRes",[null,null]),n(s(t),"hero",null),n(s(t),"map",null),n(s(t),"entrypos",[]),n(s(t),"talksCount",99),i(s(t),"dialogueBox",R,s(t)),t}o(t,e);var l=t.prototype;return l.onLoad=function(){console.log("未读取前进度："+m.ongoing.progress),m.ongoing.readLocal(),console.log("读取后进度："+m.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("map"),this.entrypos=this.map.getComponent(r).getObjectGroup("entrypos").getObjects(),console.log(this.entrypos);for(var e=0;e<this.entrypos.length;e++){var t=this.entrypos[e];console.log(t.x,t.y)}this.layoutGameProgress(),this.setEntryPos(),m.getStorageTalks("hotelRoom3"),console.log(c.getScene().name+"所有对话："),console.log(m.sceneTalks);var o=g(this.dialogueBox);this.hero.addChild(o),o.active=!1,console.log(o.name+"加载成功"),console.log("现在对话数="+this.talksCount)},l.start=function(){this.hero.getChildByName("dialogueBox").on(u.EventType.CLICK,this.onNextSpeak,this);var e=this.node.getChildByPath("map/entry").getComponent(d);e&&e.on(p.BEGIN_CONTACT,this.onEntry,this)},l.onNextSpeak=function(){var e=this;this.hero.getChildByName("dialogueBox").getComponent(u).interactable=!1,this.talksCount<m.sceneTalks.length?(7==this.talksCount&&(this.node.getChildByName("npcDoctor").active=!1),16==this.talksCount&&m.ongoing.progress++,console.log("当前第"+this.talksCount+"句，共"+m.sceneTalks.length+"句"),console.log(m.sceneTalks[this.talksCount].msg),B.haveTalks(this.hero.getChildByName("dialogueBox"),m.sceneTalks[this.talksCount]),this.talksCount++):(this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0),this.scheduleOnce((function(){e.hero.getChildByName("dialogueBox").getComponent(u).interactable=!0}),1)},l.layoutGameProgress=function(){m.ongoing.progress>=13&&(this.node.getChildByName("npcDoctor").active=!0,this.node.getChildByName("npcChild").active=!0,this.node.getChildByName("illedldn").active=!0,this.talksCount=0)},l.setEntryPos=function(){console.log("进入 "+m.ongoing.nextSceneEntryPos+" 口"),this.hero.setPosition(this.entrypos[m.ongoing.nextSceneEntryPos].x-1080,this.entrypos[m.ongoing.nextSceneEntryPos].y-140,0)},l.onEntry=function(e,t,o){m.whichEntry("heroLXY",t,e,2,c.getScene().name,"hotel")},l.update=function(e){this.searchRes=this.node.getChildByName("heroLXY").getComponent(C).onGetSearchRes(),null!=this.searchRes[0]&&(13!=m.ongoing.progress||"npcDoctor"!=this.searchRes[0].collider.node.name&&"npcChild"!=this.searchRes[0].collider.node.name||(this.hero.getChildByName("dialogueBox").active=!0,this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1,B.haveTalks(this.hero.getChildByName("dialogueBox"),m.sceneTalks[this.talksCount]),this.talksCount++),console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&(console.log(this.searchRes[1].node.name),this.searchRes[1]=null)},t}(y)).prototype,"dialogueBox",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=N))||f));l._RF.pop()}}}));

System.register("chunks:///_virtual/GlobalFunc.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./GameProgress.ts"],(function(e){"use strict";var o,l,s,n,t,i,a,g,r,c,v,m,f,u,S;return{setters:[function(e){o=e.defineProperty,l=e.inheritsLoose},function(e){s=e.cclegacy,n=e._decorator,t=e.find,i=e.sys,a=e.director,g=e.AudioSource,r=e.resources,c=e.error,v=e.SpriteFrame,m=e.Sprite,f=e.AudioClip,u=e.Component},function(e){S=e.GameProgress}],execute:function(){var b,h,j;s._RF.push({},"2d68bKx7SpCSKPvCQYdGSzf","GlobalFunc",void 0);var p=n.ccclass;n.property,e("GlobalFunc",p("GlobalFunc")((j=h=function(e){function o(){return e.apply(this,arguments)||this}return l(o,e),o.newGame=function(){this.ongoing=new S,console.log(this.ongoing.bagItems),console.log("新建游戏进度："+this.ongoing.progress),this.ongoing.saveLocal()},o._newGame=function(e,o){this.ongoing=new S,this.ongoing.progress=e,this.ongoing.nextSceneEntryPos=o,console.log("新建游戏进度："+this.ongoing.progress),this.ongoing.saveLocal()},o.saveGame=function(e,o){if(this.ongoing.lastScene=t("Canvas").parent.name,this.ongoing.savedCount=o,i.isNative){var l=JSON.stringify(this.ongoing),s=jsb.fileUtils.getWritablePath();jsb.fileUtils.writeStringToFile(l,s+"nativeGamesave"+e+".json")?console.log("成功存档：nativeGamesave"+e+".json"):console.log("未成功存档于native！")}else{var n=JSON.stringify(this.ongoing);i.localStorage.setItem("gamesave"+e,n),console.log("已存入gamesave"+e),console.log(i.localStorage.getItem("gamesave"+e))}},o.loadGame=function(e){var l=null;if(i.isNative){var s=jsb.fileUtils.getWritablePath();jsb.fileUtils.isFileExist(s+"nativeGamesave"+e+".json")?(l=jsb.fileUtils.getStringFromFile(s+"nativeGamesave"+e+".json"),console.log("native有文件")):console.log("native没有文件")}else l=i.localStorage.getItem("gamesave"+e);null!=l||null!=l?(this.ongoing=new S,i.localStorage.setItem("ongoing",l),console.log(i.localStorage.getItem("ongoing")),this.ongoing.readLocal(),console.log(this.ongoing),console.log("成功载入存档gamesave"+e)):console.log("未发现存档gamesave"+e),a.loadScene(this.ongoing.lastScene),o.changeBGM(this.ongoing.currBGM,t("bgm").getComponent(g))},o.saveSellItems=function(){i.isNative?r.load("localData/sellitems",(function(e,o){if(e)c(e.message||e);else{var l=o.json,s=JSON.stringify(l);console.log(s);var n=jsb.fileUtils.getWritablePath();console.log("可写入文件路径"+n),jsb.fileUtils.writeStringToFile(s,n+"nativeSellItems.json")?console.log("已将商品存入native"):console.log("未将商品存入native")}})):r.load("localData/sellitems",(function(e,o){if(e)c(e.message||e);else{var l=o.json,s=JSON.stringify(l);console.log(s),i.localStorage.setItem("sellItems",s),console.log("已将商品存入web")}}))},o.getStorageSellItems=function(){if(i.isNative){var e=jsb.fileUtils.getWritablePath();console.log(jsb.fileUtils.getStringFromFile(e+"nativeSellItems.json"));var o=JSON.parse(jsb.fileUtils.getStringFromFile(e+"nativeSellItems.json"));return console.log("已载入native中的商品"),o}var l=JSON.parse(i.localStorage.getItem("sellItems"));return console.log("已载入web中的商品"),l},o.saveMagics=function(){i.isNative?r.load("localData/magics",(function(e,o){if(e)c(e.message||e);else{var l=o.json,s=JSON.stringify(l);console.log(s);var n=jsb.fileUtils.getWritablePath();console.log("可写入文件路径"+n),jsb.fileUtils.writeStringToFile(s,n+"nativeMagics.json")?console.log("已将仙术存入native"):console.log("未将仙术存入native")}})):r.load("localData/magics",(function(e,o){if(e)c(e.message||e);else{var l=o.json,s=JSON.stringify(l);console.log(s),i.localStorage.setItem("magics",s),console.log("已将仙术存入web")}}))},o.getStorageMagics=function(){if(i.isNative){var e=jsb.fileUtils.getWritablePath();console.log(jsb.fileUtils.getStringFromFile(e+"nativeMagics.json"));var o=JSON.parse(jsb.fileUtils.getStringFromFile(e+"nativeMagics.json"));return console.log("已载入native中的仙术"),o}var l=JSON.parse(i.localStorage.getItem("magics"));return console.log("已载入web中的仙术"),l},o.savetoStorage=function(){i.isNative?r.load("localData/talks",(function(e,o){if(e)c(e.message||e);else{var l=o.json,s=JSON.stringify(l);console.log(s);var n=jsb.fileUtils.getWritablePath();console.log("可写入文件路径"+n),jsb.fileUtils.writeStringToFile(s,n+"nativeTalks.json")?console.log("已将对话存入native"):console.log("未将对话存入native")}})):r.load("localData/talks",(function(e,o){if(e)c(e.message||e);else{var l=o.json,s=JSON.stringify(l);console.log(s),i.localStorage.setItem("talks",s),console.log("已将对话存入web")}}))},o.getStorageTalks=function(e){if(i.isNative){var o=jsb.fileUtils.getWritablePath();console.log(jsb.fileUtils.getStringFromFile(o+"nativeTalks.json"));var l=JSON.parse(jsb.fileUtils.getStringFromFile(o+"nativeTalks.json"));this.sceneTalks=l[e],console.log("已载入native中的talks")}else{var s=JSON.parse(i.localStorage.getItem("talks"));this.sceneTalks=s[e],console.log("已载入web中的talks")}},o.changeSp=function(e,o){r.load("loadSprite/"+o+"/spriteFrame",v,(function(o,l){e.getComponent(m).spriteFrame=l}))},o.whichEntry=function(e,o,l,s,n,t){o.node.name==e&&(console.log("进入："+t+"的 "+s+" 口"),this.ongoing.nextSceneEntryPos=s,this.ongoing.saveLocal(),a.loadScene(t))},o.changeBGM=function(e,o){var l=this;null==o.clip||o.clip.name!=e?(this.ongoing.currBGM=e,o.playing&&(o.pause(),console.log("bgm暂停了")),r.load("bgm/"+e,f,(function(s,n){o.clip=n,console.log("clip就绪："+e),l.ongoing.bgmFlag?(o.play(),console.log("正播放："+e)):console.log("bgm是关闭状态")}))):console.log("音乐不变")},o.setBGM=function(e,o){e?this.ongoing.bgmFlag?console.log("bgm已经是打开状态"):(console.log("bgm已打开"),o.play(),this.ongoing.bgmFlag=!0):this.ongoing.bgmFlag?(console.log("bgm已关闭"),o.stop(),this.ongoing.bgmFlag=!1):console.log("bgm已经是关闭状态")},o.setSound=function(e){e?console.log("打开音效（未设置音效功能）"):console.log("关闭音效（未设置音效功能）")},o.getGameSaves=function(e){var o=null;if(i.isNative){var l=jsb.fileUtils.getWritablePath();jsb.fileUtils.isFileExist("nativeGamesave"+e+".json")?(o=jsb.fileUtils.getStringFromFile(l+"nativeGamesave"+e+".json"),console.log("native有文件")):console.log("native没有文件")}else o=i.localStorage.getItem("gamesave"+e);if(null!=o||null!=o){var s=JSON.parse(o);return console.log("发现存档gamesave"+e),console.log(s),s.savedCount}return console.log("未发现存档gamesave"+e),0},o}(u),o(h,"ongoing",void 0),o(h,"sceneTalks",[]),o(h,"preloadSceneName",""),b=j))||b);s._RF.pop()}}}));

System.register("chunks:///_virtual/villageWeapns.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./Seller.ts"],(function(e){"use strict";var t,o,n,s,i,l,r,a,h,c,g,p,u;return{setters:[function(e){t=e.inheritsLoose,o=e.defineProperty,n=e.assertThisInitialized},function(e){s=e.cclegacy,i=e._decorator,l=e.TiledMap,r=e.Collider2D,a=e.Contact2DType,h=e.director,c=e.Component},function(e){g=e.Controller},function(e){p=e.GlobalFunc},function(e){u=e.Seller}],execute:function(){var y;s._RF.push({},"340996iLVVNDp55leKpPD3P","villageWeapns",void 0);var d=i.ccclass;i.property,e("villageWeapns",d("villageWeapns")(y=function(e){function s(){for(var t,s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return t=e.call.apply(e,[this].concat(i))||this,o(n(t),"searchRes",[null,null]),o(n(t),"hero",null),o(n(t),"map",null),o(n(t),"entrypos",[]),o(n(t),"currItemsIndex",[9,10,11,12,13,14]),t}t(s,e);var i=s.prototype;return i.onLoad=function(){console.log("未读取前进度："+p.ongoing.progress),p.ongoing.readLocal(),console.log("读取后进度："+p.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("map"),this.entrypos=this.map.getComponent(l).getObjectGroup("entrypos").getObjects(),console.log(this.entrypos);for(var e=0;e<this.entrypos.length;e++){var t=this.entrypos[e];console.log(t.x,t.y)}this.layoutGameProgress(),this.setEntryPos()},i.start=function(){var e=this.node.getChildByPath("map/entry").getComponent(r);e&&e.on(a.BEGIN_CONTACT,this.onEntry,this)},i.layoutGameProgress=function(){},i.setEntryPos=function(){console.log("进入 "+p.ongoing.nextSceneEntryPos+" 口"),this.hero.setPosition(3.5*(this.entrypos[p.ongoing.nextSceneEntryPos].x-1032),3.5*(1048-this.entrypos[p.ongoing.nextSceneEntryPos].offset.y),0)},i.onEntry=function(e,t,o){p.whichEntry("heroLXY",t,e,0,h.getScene().name,"villageMarket")},i.onSellBoxExit=function(){this.node.getChildByName("sellBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0,console.log("现在包里有："),console.log(p.ongoing.bagItems)},i.update=function(e){this.searchRes=this.node.getChildByName("heroLXY").getComponent(g).onGetSearchRes(),null!=this.searchRes[0]&&("npcSmith"==this.searchRes[0].collider.node.name&&(this.node.getChildByName("sellBox").setPosition(this.hero.getPosition()),this.node.getChildByName("sellBox").getComponent(u).initLayout(this.currItemsIndex),this.node.getChildByName("sellBox").active=!0,this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1),console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&(console.log(this.searchRes[1].node.name),this.searchRes[1]=null)},s}(c))||y);s._RF.pop()}}}));

System.register("chunks:///_virtual/sellitemtype.ts",["cc"],(function(){"use strict";var e,t;return{setters:[function(c){e=c.cclegacy,t=c._decorator}],execute:function(){e._RF.push({},"392f113mw9JBbv0gRH6R3Lo","sellitemtype",void 0);t.ccclass,t.property;e._RF.pop()}}}));

System.register("chunks:///_virtual/villageMarket.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./ShowTalk.ts","./NpcControl.ts"],(function(e){"use strict";var t,o,n,i,s,a,l,h,r,g,c,u,d,p,C,y,m,B,v,N,k,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.defineProperty,i=e.assertThisInitialized,s=e.initializerDefineProperty},function(e){a=e.cclegacy,l=e._decorator,h=e.Prefab,r=e.TiledMap,g=e.director,c=e.instantiate,u=e.Button,d=e.Collider2D,p=e.Contact2DType,C=e.Vec3,y=e.Animation,m=e.tween,B=e.Component},function(e){v=e.Controller},function(e){N=e.GlobalFunc},function(e){k=e.ShowTalk},function(e){f=e.NpcControl}],execute:function(){var T,x,S,b,P;a._RF.push({},"46595fpD4BMs54+PX2i1/kh","villageMarket",void 0);var E=l.ccclass,L=l.property;e("villageMarket",(T=E("villageMarket"),x=L(h),T((P=t((b=function(e){function t(){for(var t,o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return t=e.call.apply(e,[this].concat(a))||this,n(i(t),"searchRes",[null,null]),n(i(t),"hero",null),n(i(t),"map",null),n(i(t),"entrypos",[]),n(i(t),"talksCount",99),s(i(t),"dialogueBox",P,i(t)),t}o(t,e);var a=t.prototype;return a.onLoad=function(){console.log("未读取前进度："+N.ongoing.progress),N.ongoing.readLocal(),console.log("读取后进度："+N.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("map"),this.entrypos=this.map.getComponent(r).getObjectGroup("entrypos").getObjects(),console.log(this.entrypos);for(var e=0;e<this.entrypos.length;e++){var t=this.entrypos[e];console.log(t.x,t.y)}this.layoutGameProgress(),this.setEntryPos(),console.log(g.getScene().name+"所有对话："),console.log(N.sceneTalks);var o=c(this.dialogueBox);this.hero.addChild(o),o.active=!1,console.log(o.name+"加载成功"),console.log("现在对话数="+this.talksCount)},a.start=function(){15==N.ongoing.progress?(this.talksCount=0,N.getStorageTalks("preIsXian1"),console.log("preIsXian1所有对话："),console.log(N.sceneTalks),this.hero.getChildByName("dialogueBox").on(u.EventType.CLICK,this.onNextSpeak1,this)):this.hero.getChildByName("dialogueBox").on(u.EventType.CLICK,this.onNextSpeak,this);var e=this.node.getChildByPath("map/entry0").getComponent(d);e&&e.on(p.BEGIN_CONTACT,this.onEntry0,this);var t=this.node.getChildByPath("map/entry3").getComponent(d);t&&t.on(p.BEGIN_CONTACT,this.onEntry3,this);var o=this.node.getChildByPath("map/setout").getComponent(d);o&&o.once(p.BEGIN_CONTACT,this.setout,this)},a.onNextSpeak1=function(){var e=this;this.hero.getChildByName("dialogueBox").getComponent(u).interactable=!1,this.talksCount<N.sceneTalks.length?(this.talksCount==N.sceneTalks.length-2&&(console.log("撑船"),this.node.getChildByPath("map/colli/enterboat").active=!1,this.node.getChildByName("npcZhangsi").getComponent(f).getMoveTo=new C(464,-1263)),this.talksCount==N.sceneTalks.length-1&&this.node.getChildByName("npcZhangsi").getComponent(y).play("drive"),console.log("当前第"+this.talksCount+"句，共"+N.sceneTalks.length+"句"),console.log(N.sceneTalks[this.talksCount].msg),k.haveTalks(this.hero.getChildByName("dialogueBox"),N.sceneTalks[this.talksCount]),this.talksCount++):(console.log("没有对话"),this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0),this.scheduleOnce((function(){e.hero.getChildByName("dialogueBox").getComponent(u).interactable=!0}),1)},a.onNextSpeak=function(){var e=this;this.hero.getChildByName("dialogueBox").getComponent(u).interactable=!1,this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0,N.ongoing.progress=12,this.scheduleOnce((function(){e.hero.getChildByName("dialogueBox").getComponent(u).interactable=!0}),1)},a.layoutGameProgress=function(){8!=N.ongoing.progress&&11!=N.ongoing.progress||(this.talksCount=10)},a.setEntryPos=function(){console.log("进入 "+N.ongoing.nextSceneEntryPos+" 口"),this.hero.setPosition(3.5*(this.entrypos[N.ongoing.nextSceneEntryPos].x-1040),3.5*this.entrypos[N.ongoing.nextSceneEntryPos].y,0)},a.onEntry0=function(e,t,o){N.whichEntry("heroLXY",t,e,0,g.getScene().name,"villageWeapons")},a.onEntry3=function(e,t,o){N.whichEntry("heroLXY",t,e,1,g.getScene().name,"village")},a.setout=function(){var e=this;this.hero.getComponent(v).onStop(),this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1,N.ongoing.nextSceneEntryPos=1,N.ongoing.saveLocal(),m(this.node.getChildByName("heroLXY")).by(5,{position:new C(320,160)},{onStart:function(){m(e.node.getChildByName("npcZhangsi")).by(5,{position:new C(320,160)}).start(),m(e.node.getChildByName("boat")).by(5,{position:new C(320,160)}).start()},onComplete:function(){g.loadScene("IsXianWharf")}}).start()},a.update=function(e){this.searchRes=this.node.getChildByName("heroLXY").getComponent(v).onGetSearchRes(),null!=this.searchRes[0]&&("npcZhangsi"!=this.searchRes[0].collider.node.name||8!=N.ongoing.progress&&11!=N.ongoing.progress&&15!=N.ongoing.progress||(this.hero.getChildByName("dialogueBox").active=!0,this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1,k.haveTalks(this.hero.getChildByName("dialogueBox"),N.sceneTalks[this.talksCount]),this.talksCount++),console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&(console.log(this.searchRes[1].node.name),this.searchRes[1]=null)},t}(B)).prototype,"dialogueBox",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=b))||S));a._RF.pop()}}}));

System.register("chunks:///_virtual/Seller.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./GlobalFunc.ts"],(function(e){"use strict";var t,i,n,o,s,c,h,l,r,a,m,g,d,u,C;return{setters:[function(e){t=e.inheritsLoose,i=e.defineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,s=e._decorator,c=e.Label,h=e.Color,l=e.Button,r=e.resources,a=e.SpriteFrame,m=e.Sprite,g=e.Component,d=e.Prefab,u=e.instantiate},function(e){C=e.GlobalFunc}],execute:function(){var p;o._RF.push({},"53020+hnSFBUJ1MLhicoUZY","Seller",void 0);var y=s.ccclass;s.property,e("Seller",y("Seller")(p=function(e){function o(){for(var t,o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return t=e.call.apply(e,[this].concat(s))||this,i(n(t),"currItems",[]),i(n(t),"items",[]),i(n(t),"selected",0),t}t(o,e);var s=o.prototype;return s.initLayout=function(e){this.selected=0,this.currItems=e;var t=C.getStorageSellItems();Object.assign(this.items,t),console.log(this.items),this.changePic(this.node.getChildByPath("itempic/pic"),this.items[this.currItems[0]].picurl),this.node.getChildByPath("owned/textnum").getComponent(c).string=String(C.ongoing.getBagItem(this.currItems[this.selected])),this.layoutItems()},s.layoutItems=function(){var e=this;this.node.getChildByName("items").removeAllChildren();for(var t=function(t){var i=e.currItems[t];r.load("prefabs/sellItem",d,(function(t,n){var o=u(n);o.getChildByName("itemname").getComponent(c).string=e.items[i].name,o.getChildByName("itemprice").getComponent(c).string=String(e.items[i].price),e.node.getChildByName("items").addChild(o),console.log("上架一个。"),o.on(l.EventType.CLICK,e.selectedItem,e)}))},i=0;i<this.currItems.length;i++)t(i)},s.onButtonYes=function(){C.ongoing.coins<this.items[this.currItems[this.selected]].price?this.node.getChildByPath("btYesONo/notice").active=!0:(console.log("购买成功"),C.ongoing.coins-=this.items[this.currItems[this.selected]].price,C.ongoing.addToBagItems(this.currItems[this.selected]),this.node.getChildByName("btYesONo").active=!1,this.node.getChildByName("items").children[this.selected].getChildByName("itemname").getComponent(c).color=new h(255,255,255),this.setTouchable())},s.onButtonNo=function(){console.log("取消购买"),this.node.getChildByPath("btYesONo/notice").active&&(this.node.getChildByPath("btYesONo/notice").active=!1),this.node.getChildByName("btYesONo").active=!1,this.node.getChildByName("items").children[this.selected].getChildByName("itemname").getComponent(c).color=new h(255,255,255),this.setTouchable()},s.setUntouchable=function(){this.node.getChildByName("exit").getComponent(l).interactable=!1,this.node.getChildByName("items").children.forEach((function(e){e.getComponent(l).interactable=!1}))},s.setTouchable=function(){this.node.getChildByName("exit").getComponent(l).interactable=!0,this.node.getChildByName("items").children.forEach((function(e){e.getComponent(l).interactable=!0}))},s.selectedItem=function(e){e.node.getChildByName("itemname").getComponent(c).color=new h(244,228,108),this.setUntouchable(),this.node.getChildByName("btYesONo").active=!0,this.selected=e.node.getSiblingIndex(),console.log(this.currItems[this.selected]),console.log(this.items[this.currItems[this.selected]]),this.changePic(this.node.getChildByPath("itempic/pic"),this.items[this.currItems[this.selected]].picurl)},s.changePic=function(e,t){r.load("sellitemspic/"+t+"/spriteFrame",a,(function(t,i){e.getComponent(m).spriteFrame=i}))},s.update=function(){C.ongoing.hasBagItem(this.currItems[this.selected])?this.node.getChildByPath("owned/textnum").getComponent(c).string=String(C.ongoing.getBagItem(this.currItems[this.selected])):this.node.getChildByPath("owned/textnum").getComponent(c).string="0",this.node.getChildByPath("remainCoins/textnum").getComponent(c).string=String(C.ongoing.coins)},o}(g))||p);o._RF.pop()}}}));

System.register("chunks:///_virtual/MainMenu.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./GlobalFunc.ts"],(function(t){"use strict";var e,s,i,n,o,a,h,g,d,m,c,y,r,l,C,b,v,S;return{setters:[function(t){e=t.inheritsLoose,s=t.defineProperty,i=t.assertThisInitialized},function(t){n=t.cclegacy,o=t._decorator,a=t.Label,h=t.Button,g=t.find,d=t.AudioSource,m=t.game,c=t.resources,y=t.SpriteFrame,r=t.Sprite,l=t.Color,C=t.Component,b=t.Prefab,v=t.instantiate},function(t){S=t.GlobalFunc}],execute:function(){var B;n._RF.push({},"631281D4VNOQJHFzW+ibz2J","MainMenu",void 0);var p=o.ccclass;o.property,t("MainMenu",p("MainMenu")(B=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,s(i(e),"selected",0),s(i(e),"items",[]),s(i(e),"magics",[]),e}e(n,t);var o=n.prototype;return o.onLoad=function(){this.node.getChildByPath("lcmoney/coins").getComponent(a).string=String(S.ongoing.coins)},o.start=function(){this.node.on(h.EventType.CLICK,this.onMenuOpen,this),this.node.getChildByPath("settings/btMagic").on(h.EventType.CLICK,this.onShowMagics,this),this.node.getChildByPath("settings/btItems").on(h.EventType.CLICK,this.onShowItems,this),this.node.getChildByPath("settings/btSystem").on(h.EventType.CLICK,this.onShowSystem,this),this.node.getChildByPath("settings/btSystem/system/btSave").on(h.EventType.CLICK,this.onShowProgrss,this),this.node.getChildByPath("settings/btSystem/system/btLoad").on(h.EventType.CLICK,this.onShowProgrss,this),this.node.getChildByPath("settings/btSystem/system/btBGM").on(h.EventType.CLICK,this.onShowChoice,this),this.node.getChildByPath("settings/btSystem/system/btSound").on(h.EventType.CLICK,this.onShowChoice,this),this.node.getChildByPath("settings/btSystem/system/btEndGame").on(h.EventType.CLICK,this.onShowChoice,this),this.node.getChildByPath("settings/btSystem/system/btBGM/btYesONo/btYes").on(h.EventType.CLICK,this.onChoiceConfirmed,this),this.node.getChildByPath("settings/btSystem/system/btBGM/btYesONo/btNo").on(h.EventType.CLICK,this.onChoiceCancelled,this),this.node.getChildByPath("settings/btSystem/system/btSound/btYesONo/btYes").on(h.EventType.CLICK,this.onChoiceConfirmed,this),this.node.getChildByPath("settings/btSystem/system/btSound/btYesONo/btNo").on(h.EventType.CLICK,this.onChoiceCancelled,this),this.node.getChildByPath("settings/btSystem/system/btEndGame/btYesONo/btYes").on(h.EventType.CLICK,this.onChoiceConfirmed,this),this.node.getChildByPath("settings/btSystem/system/btEndGame/btYesONo/btNo").on(h.EventType.CLICK,this.onChoiceCancelled,this),this.node.getChildByPath("settings/btSystem/system/btSave/bars/btProgress1").on(h.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("settings/btSystem/system/btSave/bars/btProgress2").on(h.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("settings/btSystem/system/btSave/bars/btProgress3").on(h.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("settings/btSystem/system/btSave/bars/btProgress4").on(h.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("settings/btSystem/system/btSave/bars/btProgress5").on(h.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("settings/btSystem/system/btLoad/bars/btProgress1").on(h.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("settings/btSystem/system/btLoad/bars/btProgress2").on(h.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("settings/btSystem/system/btLoad/bars/btProgress3").on(h.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("settings/btSystem/system/btLoad/bars/btProgress4").on(h.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("settings/btSystem/system/btLoad/bars/btProgress5").on(h.EventType.CLICK,this.onManageGameSaves,this);var t=S.getStorageSellItems();Object.assign(this.items,t),console.log(this.items);var e=S.getStorageMagics();Object.assign(this.magics,e),console.log(this.magics)},o.onChoiceConfirmed=function(t){"btBGM"==t.node.parent.parent.name?(S.setBGM(!0,g("bgm").getComponent(d)),t.node.parent.active=!1):"btSound"==t.node.parent.parent.name?(S.setSound(!0),t.node.parent.active=!1):"btEndGame"==t.node.parent.parent.name&&(S.ongoing.saveLocal(),m.end())},o.onChoiceCancelled=function(t){"btBGM"==t.node.parent.parent.name?S.setBGM(!1,g("bgm").getComponent(d)):"btSound"==t.node.parent.parent.name&&S.setSound(!1),t.node.parent.active=!1},o.onShowChoice=function(t){this.node.getChildByPath("settings/btSystem/system/btSave/bars").active&&(this.node.getChildByPath("settings/btSystem/system/btSave/bars").active=!1),this.node.getChildByPath("settings/btSystem/system/btLoad/bars").active&&(this.node.getChildByPath("settings/btSystem/system/btLoad/bars").active=!1),this.node.getChildByPath("settings/btSystem/system/btBGM/btYesONo").active&&(this.node.getChildByPath("settings/btSystem/system/btBGM/btYesONo").active=!1),this.node.getChildByPath("settings/btSystem/system/btSound/btYesONo").active&&(this.node.getChildByPath("settings/btSystem/system/btSound/btYesONo").active=!1),this.node.getChildByPath("settings/btSystem/system/btEndGame/btYesONo").active&&(this.node.getChildByPath("settings/btSystem/system/btEndGame/btYesONo").active=!1),t.node.getChildByName("btYesONo").active=!0,console.log(t.node.name)},o.onShowProgrss=function(t){this.node.getChildByPath("settings/btSystem/system/btSave/bars").active&&(this.node.getChildByPath("settings/btSystem/system/btSave/bars").active=!1),this.node.getChildByPath("settings/btSystem/system/btLoad/bars").active&&(this.node.getChildByPath("settings/btSystem/system/btLoad/bars").active=!1),this.node.getChildByPath("settings/btSystem/system/btBGM/btYesONo").active&&(this.node.getChildByPath("settings/btSystem/system/btBGM/btYesONo").active=!1),this.node.getChildByPath("settings/btSystem/system/btSound/btYesONo").active&&(this.node.getChildByPath("settings/btSystem/system/btSound/btYesONo").active=!1),this.node.getChildByPath("settings/btSystem/system/btEndGame/btYesONo").active&&(this.node.getChildByPath("settings/btSystem/system/btEndGame/btYesONo").active=!1),t.node.getChildByName("bars").active=!0,console.log(t.node.name),t.node.getChildByName("bars").children.forEach((function(t){t.getChildByName("num").getComponent(a).string=S.getGameSaves(t.getSiblingIndex())}))},o.onManageGameSaves=function(t){if("btSave"==t.node.parent.parent.name){var e=0;t.node.parent.children.forEach((function(t){Number(t.getChildByName("num").getComponent(a).string)>e&&(e=Number(t.getChildByName("num").getComponent(a).string))})),S.saveGame(t.node.getSiblingIndex(),e+1),this.onMenuExit()}else"0"!=t.node.getChildByName("num").getComponent(a).string?(S.newGame(),S.loadGame(t.node.getSiblingIndex())):this.onMenuExit()},o.onShowSystem=function(){this.node.getChildByPath("settings/btSystem/system").active=!0},o.onShowMagics=function(){this.node.getComponent(h).interactable=!1,this.selected=0,this.closeOtherWindows(),this.node.getChildByName("magicUnits").active=!0,this.node.getChildByName("lcmoney").active=!1,this.node.getChildByName("exit").active=!1,this.node.getChildByPath("settings").active&&(this.node.getChildByPath("settings").active=!1),this.initMagicItems(),this.layoutMagics()},o.initMagicItems=function(){var t=this;this.node.getChildByPath("magicUnits/brief/hpall").getComponent(a).string=String(S.ongoing.herostate[0]),this.node.getChildByPath("magicUnits/brief/mpall").getComponent(a).string=String(S.ongoing.herostate[1]),this.node.getChildByPath("magicUnits/brief/hpcurr").getComponent(a).string=String(S.ongoing.herocurrstate[0]),this.node.getChildByPath("magicUnits/brief/mpcurr").getComponent(a).string=String(S.ongoing.herocurrstate[1]),c.load("battle/briefAvatar/spriteFrame",y,(function(e,s){t.node.getChildByPath("magicUnits/brief/avatar").getComponent(r).spriteFrame=s})),this.node.getChildByPath("magicUnits/magicFigure/myCurr").getComponent(a).string=String(S.ongoing.herocurrstate[1]),this.node.getChildByPath("magicUnits/magicFigure/thisMagic").getComponent(a).string=this.magics[S.ongoing.currMagics[0]].smp,this.node.getChildByPath("magicUnits/introduce").getComponent(a).string=this.magics[S.ongoing.currMagics[0]].introduce},o.layoutMagics=function(){var t=this;this.node.getChildByPath("magicUnits/magics").removeAllChildren();for(var e=function(e){var s=S.ongoing.currMagics[e];c.load("prefabs/magicitem1",b,(function(e,i){var n=v(i);n.getComponent(a).string=t.magics[s].name,t.node.getChildByPath("magicUnits/magics").addChild(n),console.log("陈列一种仙术"),n.on(h.EventType.CLICK,t.selectedMagic,t)}))},s=0;s<S.ongoing.currMagics.length;s++)e(s)},o.selectedMagic=function(t){t.node.getComponent(a).color=new l(244,228,108),this.selected!=t.node.getSiblingIndex()&&(this.node.getChildByPath("magicUnits/magics").children[this.selected].getComponent(a).color=l.WHITE),this.selected=t.node.getSiblingIndex(),console.log(this.magics[S.ongoing.currMagics[this.selected]]),this.node.getChildByPath("magicUnits/introduce").getComponent(a).string=this.magics[S.ongoing.currMagics[this.selected]].introduce,this.node.getChildByPath("magicUnits/magicFigure/thisMagic").getComponent(a).string=this.magics[S.ongoing.currMagics[this.selected]].smp},o.onShowItems=function(){this.node.getComponent(h).interactable=!1,this.selected=0,this.closeOtherWindows(),this.node.getChildByName("itemUnits").active=!0,this.node.getChildByName("lcmoney").active=!1,this.node.getChildByName("exit").active=!1,this.node.getChildByPath("settings").active&&(this.node.getChildByPath("settings").active=!1),0!=S.ongoing.bagItems.length?(this.node.getChildByPath("itemUnits/itempic/pic").getComponent(r).spriteFrame=null,this.node.getChildByPath("itemUnits/introduce").getComponent(a).string="",this.layoutItems()):(this.node.getChildByPath("itemUnits/items").removeAllChildren(),this.node.getChildByPath("itemUnits/itempic/pic").getComponent(r).spriteFrame=null,this.node.getChildByPath("itemUnits/introduce").getComponent(a).string="")},o.layoutItems=function(){var t=this;this.node.getChildByPath("itemUnits/items").removeAllChildren();for(var e=function(e){var s=S.ongoing.bagItems[e];c.load("prefabs/bagitem1",b,(function(e,i){var n=v(i);n.getComponent(a).string=t.items[s[0]].name,n.getChildByName("count").getComponent(a).string=String(s[1]),t.node.getChildByPath("itemUnits/items").addChild(n),console.log("陈列一个物品"),n.on(h.EventType.CLICK,t.selectedItem,t)}))},s=0;s<S.ongoing.bagItems.length;s++)e(s)},o.selectedItem=function(t){t.node.getComponent(a).color=new l(244,228,108),this.selected!=t.node.getSiblingIndex()&&(this.node.getChildByPath("itemUnits/items").children[this.selected].getComponent(a).color=l.WHITE),this.selected=t.node.getSiblingIndex(),console.log(this.items[S.ongoing.bagItems[this.selected][0]]),this.changePic(this.node.getChildByPath("itemUnits/itempic/pic"),this.items[S.ongoing.bagItems[this.selected][0]].picurl),this.node.getChildByPath("itemUnits/introduce").getComponent(a).string=this.items[S.ongoing.bagItems[this.selected][0]].introduce},o.onMenuOpen=function(){this.node.getChildByName("lcmoney").active=!0,this.node.getChildByName("settings").active=!0,this.node.getChildByName("exit").active=!0,this.node.getChildByPath("lcmoney/coins").getComponent(a).string=String(S.ongoing.coins),this.node.parent.getChildByName("ctrller").active=!1,this.node.parent.getChildByName("hand").active=!1},o.onMenuExit=function(){this.node.getComponent(h).interactable=!0,this.node.getChildByName("lcmoney").active=!1,this.closeOtherWindows(),this.node.getChildByName("settings").active=!1,this.node.getChildByName("exit").active=!1,this.node.getChildByName("itemUnits").active&&(this.node.getChildByName("itemUnits").active=!1),this.node.getChildByName("magicUnits").active&&(this.node.getChildByName("magicUnits").active=!1),this.node.parent.getChildByName("ctrller").active=!0,this.node.parent.getChildByName("hand").active=!0},o.closeOtherWindows=function(){this.node.getChildByPath("settings/btSystem/system/btSave/bars").active&&(this.node.getChildByPath("settings/btSystem/system/btSave/bars").active=!1),this.node.getChildByPath("settings/btSystem/system/btLoad/bars").active&&(this.node.getChildByPath("settings/btSystem/system/btLoad/bars").active=!1),this.node.getChildByPath("settings/btSystem/system/btBGM/btYesONo").active&&(this.node.getChildByPath("settings/btSystem/system/btBGM/btYesONo").active=!1),this.node.getChildByPath("settings/btSystem/system/btSound/btYesONo").active&&(this.node.getChildByPath("settings/btSystem/system/btSound/btYesONo").active=!1),this.node.getChildByPath("settings/btSystem/system/btEndGame/btYesONo").active&&(this.node.getChildByPath("settings/btSystem/system/btEndGame/btYesONo").active=!1),this.node.getChildByPath("settings/btSystem/system").active=!1},o.changePic=function(t,e){c.load("sellitemspic/"+e+"/spriteFrame",y,(function(e,s){t.getComponent(r).spriteFrame=s}))},n}(C))||B);n._RF.pop()}}}));

System.register("chunks:///_virtual/myRoom.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./ShowTalk.ts","./NpcControl.ts","./MainMenu.ts"],(function(e){"use strict";var t,o,n,i,h,s,a,l,g,r,d,C,c,m,y,u,p,B,L,N,k,X,Y,f,v,R,S,P,x,T,b,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.defineProperty,i=e.assertThisInitialized,h=e.initializerDefineProperty},function(e){s=e.cclegacy,a=e._decorator,l=e.Prefab,g=e.JsonAsset,r=e.instantiate,d=e.Label,C=e.UITransform,c=e.Widget,m=e.find,y=e.AudioSource,u=e.Input,p=e.Collider2D,B=e.Contact2DType,L=e.director,N=e.Button,k=e.Animation,X=e.Vec3,Y=e.tween,f=e.resources,v=e.SpriteFrame,R=e.Sprite,S=e.Component},function(e){P=e.Controller},function(e){x=e.GlobalFunc},function(e){T=e.ShowTalk},function(e){b=e.NpcControl},function(e){w=e.MainMenu}],execute:function(){var M,E,D,G,F,I,_;s._RF.push({},"662d4tfaJ9CNIxt0fU/JVaH","myRoom",void 0);var H=a.ccclass,O=a.property;e("myRoom",(M=H("myRoom"),E=O(l),D=O(g),M((I=t((F=function(e){function t(){for(var t,o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t=e.call.apply(e,[this].concat(s))||this,n(i(t),"searchRes",[null,null]),n(i(t),"deltaTimeCount",0),n(i(t),"talksCount",9999),n(i(t),"myRoomTalks",null),h(i(t),"dialogueBox",I,i(t)),h(i(t),"itemGiftJson",_,i(t)),t}o(t,e);var s=t.prototype;return s.onLoad=function(){var e=this;console.log("未读取前进度："+x.ongoing.progress),x.ongoing.readLocal(),console.log("读取后进度："+x.ongoing.progress),this.myRoomTalks=this.itemGiftJson.json.myRoom,console.log("已加载完对话");var t=r(this.dialogueBox);this.node.getChildByName("heroLXY").addChild(t),t.active=!1,console.log(t.name+"预制体加载成功"),this.node.getChildByName("heroLXY").active=!1,this.node.getChildByName("mapMyRoom").active=!1,console.log("当前进度："+x.ongoing.progress),0==x.ongoing.progress?(console.log("对话开始"),this.talksCount=0,this.node.getChildByName("wake").active=!0,T.showOneByOne(this.node.getChildByName("wake").getComponent(d),this.node.getChildByName("wake").getComponent(d).string),this.onChangeSp(this.node.getChildByName("heroLXY"),"sleep"),this.onChangeSp(this.node.getChildByName("npcLDN"),"hitldn"),this.node.getChildByName("heroLXY").getComponent(C).setContentSize(44,32),this.scheduleOnce((function(){t.active=!0,t.addComponent(c).target=e.node.getChildByName("heroLXY"),e.node.getChildByName("heroLXY").active=!0,e.node.getChildByPath("heroLXY/ctrller").active=!1,e.node.getChildByPath("heroLXY/hand").active=!1}),1),console.log("人物初始完成")):(this.setEntryPos(),this.node.getChildByName("heroLXY").active=!0,this.node.getChildByName("mapMyRoom").active=!0,x.changeBGM("bgmHotel",m("bgm").getComponent(y)))},s.start=function(){this.node.getChildByPath("heroLXY/dialogueBox").on(u.EventType.TOUCH_END,this.onNextSpeak,this);var e=this.node.getChildByPath("mapMyRoom/entry0").getComponent(p),t=this.node.getChildByPath("mapMyRoom/entry1").getComponent(p);e&&e.on(B.BEGIN_CONTACT,this.onEntry0,this),t&&t.on(B.BEGIN_CONTACT,this.onEntry1,this)},s.setEntryPos=function(){console.log("进入 "+x.ongoing.nextSceneEntryPos+" 口"),0==x.ongoing.nextSceneEntryPos?this.node.getChildByName("mapMyRoom").setPosition(452,98,0):this.node.getChildByName("mapMyRoom").setPosition(-88,-166,0)},s.onEntry0=function(e,t,o){x.whichEntry("heroLXY",t,e,6,L.getScene().name,"hotel")},s.onEntry1=function(e,t,o){1==x.ongoing.progress?(console.log("剧情不许离开"),this.node.getChildByPath("heroLXY").getComponent(P).onStop(),this.node.getChildByPath("heroLXY/dialogueBox").active=!0,this.node.getChildByPath("heroLXY/ctrller").active=!1,this.node.getChildByPath("heroLXY/hand").active=!1,T.haveTalks(this.node.getChildByPath("heroLXY/dialogueBox"),this.myRoomTalks[24]),console.log("当前计数=="+this.talksCount),this.talksCount=24,console.log("计数是否重置=="+this.talksCount)):x.whichEntry("heroLXY",t,e,1,L.getScene().name,"hotelStore")},s.onNextSpeak=function(){var e=this;this.node.getChildByPath("heroLXY/dialogueBox").getComponent(N).interactable=!1,this.talksCount<this.myRoomTalks.length-1?(1==this.talksCount&&(this.node.getChildByName("wake").active=!1,this.node.getChildByName("mapMyRoom").active=!0,x.changeBGM("bgmHotel",m("bgm").getComponent(y)),this.node.getChildByName("npcLDN").active=!0),4==this.talksCount&&(this.onChangeSp(this.node.getChildByName("heroLXY"),"standlxy"),this.node.getChildByName("heroLXY").getComponent(C).setContentSize(22,50)),10==this.talksCount&&this.onChangeSp(this.node.getChildByName("heroLXY"),"standrlxy"),13==this.talksCount&&this.onChangeSp(this.node.getChildByName("heroLXY"),"handsinarmlxy"),14==this.talksCount&&this.onChangeSp(this.node.getChildByName("heroLXY"),"kflxy"),15==this.talksCount&&(this.node.getChildByName("heroLXY").getComponent(k).play("gotHit"),this.node.getChildByName("npcLDN").getComponent(k).play("hit")),17==this.talksCount&&(this.onChangeSp(this.node.getChildByName("heroLXY"),"standlxy"),this.node.getChildByName("npcLDN").getComponent(b).getMoveBy=new X(-320,-160)),18==this.talksCount&&this.onChangeSp(this.node.getChildByName("npcLDN"),"standuldn"),19==this.talksCount&&(this.node.getChildByName("npcLDN").getComponent(b).getMoveBy=new X(-960,-480),Y(this.node.getChildByName("heroLXY")).by(1,{position:new X(48,-24)},{onStart:function(){e.node.getChildByName("heroLXY").getComponent(P).onWalkRight()},onComplete:function(){Y(e.node.getChildByName("heroLXY")).by(1,{position:new X(48,24)},{onStart:function(){e.node.getChildByName("heroLXY").getComponent(P).onWalkUp()},onComplete:function(){e.node.getChildByName("heroLXY").getComponent(P).onStop(),e.onChangeSp(e.node.getChildByName("heroLXY"),"standlxy")}}).start()}}).start()),20==this.talksCount&&(this.node.getChildByName("npcLDN").active=!1,this.onChangeSp(this.node.getChildByName("heroLXY"),"standulxy")),22==this.talksCount&&this.onChangeSp(this.node.getChildByName("heroLXY"),"standlxy"),console.log("当前第"+this.talksCount+"句，共"+this.myRoomTalks.length+"句"),console.log(this.myRoomTalks[this.talksCount].msg),T.haveTalks(this.node.getChildByPath("heroLXY/dialogueBox"),this.myRoomTalks[this.talksCount]),this.talksCount++):1==x.ongoing.progress?(24==this.talksCount?(T.haveTalks(this.node.getChildByPath("heroLXY/dialogueBox"),this.myRoomTalks[21]),this.talksCount++):25==this.talksCount?(T.haveTalks(this.node.getChildByPath("heroLXY/dialogueBox"),this.myRoomTalks[22]),this.talksCount++):(this.node.getChildByPath("heroLXY/dialogueBox").active=!1,this.node.getChildByPath("heroLXY/ctrller").active=!0,this.node.getChildByPath("heroLXY/hand").active=!0),console.log("当前计数=="+this.talksCount)):(console.log("对话结束"),x.ongoing.progress++,console.log("对话结束，当前进度="+x.ongoing.progress),L.preloadScene("hotel"),L.preloadScene("hotelStore"),this.node.getChildByPath("heroLXY/dialogueBox").active=!1,this.node.getChildByPath("heroLXY/ctrller").active=!0,this.node.getChildByPath("heroLXY/hand").active=!0),this.scheduleOnce((function(){e.node.getChildByPath("heroLXY/dialogueBox").getComponent(N).interactable=!0}),1)},s.onChangeSp=function(e,t){f.load("loadSprite/"+t+"/spriteFrame",v,(function(t,o){e.getComponent(R).spriteFrame=o}))},s.update=function(e){this.searchRes=this.node.getChildByName("heroLXY").getComponent(P).onGetSearchRes(),null!=this.searchRes[0]&&(console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&(console.log(this.searchRes[1].node.name),32==this.searchRes[1].group&&(x.ongoing.addToBagItems(this.searchRes[1].tag),console.log(typeof x.ongoing.bagItems),this.node.getChildByName("heroLXY").getComponent(P).onFlashHint("找到："+this.node.getChildByPath("heroLXY/mainMenu").getComponent(w).items[this.searchRes[1].tag].name)),this.searchRes[1].node.active=!1,this.searchRes[1]=null)},t}(S)).prototype,"dialogueBox",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(F.prototype,"itemGiftJson",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=F))||G));s._RF.pop()}}}));

System.register("chunks:///_virtual/IsXianValley.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./GlobalFunc.ts"],(function(o){"use strict";var n,e,t,s,i,r,l,a,g,c,h,y,p;return{setters:[function(o){n=o.inheritsLoose,e=o.defineProperty,t=o.assertThisInitialized},function(o){s=o.cclegacy,i=o._decorator,r=o.TiledMap,l=o.Collider2D,a=o.Contact2DType,g=o.sys,c=o.Vec3,h=o.director,y=o.Component},function(o){p=o.GlobalFunc}],execute:function(){var u;s._RF.push({},"7d2cbPyuXhKqLTfo998cxM2","IsXianValley",void 0);var d=i.ccclass;i.property,o("IsXianValley",d("IsXianValley")(u=function(o){function s(){for(var n,s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=o.call.apply(o,[this].concat(i))||this,e(t(n),"hero",null),e(t(n),"map",null),e(t(n),"entrypos",[]),n}n(s,o);var i=s.prototype;return i.onLoad=function(){console.log("未读取前进度："+p.ongoing.progress),p.ongoing.readLocal(),console.log("读取后进度："+p.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("map"),this.entrypos=this.map.getComponent(r).getObjectGroup("entrypos").getObjects(),console.log(this.entrypos);for(var o=0;o<this.entrypos.length;o++){var n=this.entrypos[o];console.log(n.x,n.y)}this.layoutGameProgress()},i.start=function(){var o=this.node.getChildByPath("map/entry0").getComponent(l);o&&o.on(a.BEGIN_CONTACT,this.onEntry0,this);var n=this.node.getChildByPath("map/entry1").getComponent(l);n&&n.on(a.BEGIN_CONTACT,this.onEntry1,this)},i.layoutGameProgress=function(){var o=this,n=99,e=89;g.isNative?(console.log(p.ongoing.lastPos._array),n=p.ongoing.lastPos._array[0],e=p.ongoing.lastPos._array[1]):(n=p.ongoing.lastPos.x,e=p.ongoing.lastPos.y),console.log(n),console.log(e),0!=n||0!=e?(console.log("从战场返回"),this.hero.setPosition(new c(n,e)),p.ongoing.killedEnemies.forEach((function(n){o.node.getChildByPath("enemies/"+n).isValid&&(o.node.getChildByPath("enemies/"+n).active=!1)}))):(console.log("从别处入口进入"),this.setEntryPos(),0!=p.ongoing.killedEnemies.length&&(console.log("上个场景战斗敌人名单已清空"),p.ongoing.killedEnemies.length=0))},i.setEntryPos=function(){console.log("进入 "+p.ongoing.nextSceneEntryPos+" 口"),this.hero.setPosition(3.5*(this.entrypos[p.ongoing.nextSceneEntryPos].x-1032),3.5*(1048-this.entrypos[p.ongoing.nextSceneEntryPos].offset.y),0)},i.onEntry0=function(o,n,e){p.ongoing.lastPos=new c(0,0),p.whichEntry("heroLXY",n,o,1,h.getScene().name,"IsXianMaze")},i.onEntry1=function(o,n,e){p.ongoing.lastPos=new c(0,0),p.whichEntry("heroLXY",n,o,0,h.getScene().name,"IsXianWharf")},s}(y))||u);s._RF.pop()}}}));

System.register("chunks:///_virtual/startMenu.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./GlobalFunc.ts"],(function(e){"use strict";var t,o,n,a,i,s,d,m,h,r,l,g,c,y;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,n=e._decorator,a=e.game,i=e.find,s=e.VideoPlayer,d=e.Button,m=e.AudioSource,h=e.director,r=e.resources,l=e.AudioClip,g=e.Label,c=e.Component},function(e){y=e.GlobalFunc}],execute:function(){var u;o._RF.push({},"b06fcV0599EKI6tI2vPn12y","startMenu",void 0);var b=n.ccclass;n.property,e("startMenu",b("startMenu")(u=function(e){function o(){return e.apply(this,arguments)||this}t(o,e);var n=o.prototype;return n.start=function(){y.savetoStorage(),y.saveSellItems(),y.saveMagics(),a.addPersistRootNode(i("bgm")),this.node.getChildByName("preGame").once(s.EventType.READY_TO_PLAY,this.onPlayVideo,this.node.getChildByName("preGame")),this.node.getChildByName("preGame").once(s.EventType.COMPLETED,this.onSkip,this),this.node.getChildByName("myDream").once(s.EventType.READY_TO_PLAY,this.onPlayVideo,this.node.getChildByName("myDream")),this.node.getChildByName("myDream").once(s.EventType.COMPLETED,this.onLoadNextScene,this),this.node.getChildByPath("startMenu/btNewNLoad/btLoadGame/bars/btProgress1").on(d.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("startMenu/btNewNLoad/btLoadGame/bars/btProgress2").on(d.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("startMenu/btNewNLoad/btLoadGame/bars/btProgress3").on(d.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("startMenu/btNewNLoad/btLoadGame/bars/btProgress4").on(d.EventType.CLICK,this.onManageGameSaves,this),this.node.getChildByPath("startMenu/btNewNLoad/btLoadGame/bars/btProgress5").on(d.EventType.CLICK,this.onManageGameSaves,this)},n.onPlayVideo=function(){i("bgm").getComponent(m).playing&&i("bgm").getComponent(m).pause(),console.log(this.name+"开始播放"),this.getComponent(s).play()},n.onLoadNextScene=function(){console.log("切换myRoom场景"),h.loadScene("myRoom")},n.onSkip=function(){console.log("视频跳过！/视频播放完成！"),1==this.node.getChildByName("preGame").active&&(this.node.getChildByName("preGame").getComponent(s).destroy(),this.node.getChildByName("preGame").active=!1,this.node.getChildByName("startMenu").active=!0,r.load("bgm/bgmStartMenu",l,(function(e,t){i("bgm").getComponent(m).clip=t,console.log("clip就绪"),i("bgm").getComponent(m).play()}))),1==this.node.getChildByName("myDream").active&&(this.node.getChildByName("myDream").getComponent(s).destroy(),this.node.getChildByName("myDream").active=!1,console.log("切换myRoom场景"),h.loadScene("myRoom")),this.node.getChildByName("btSkip").active=!1},n.onLoadGame=function(e){this.node.getChildByPath("startMenu/btNewNLoad/btLoadGame/bars").children.forEach((function(e){e.getChildByName("num").getComponent(g).string=y.getGameSaves(e.getSiblingIndex())})),console.log("加载存档？"),this.node.getChildByPath("startMenu/btNewNLoad/btNewGame/btYesONo").active=!1,this.node.getChildByPath("startMenu/btNewNLoad/btLoadGame/bars").active=!0},n.onManageGameSaves=function(e){"0"!=e.node.getChildByName("num").getComponent(g).string?y.loadGame(e.node.getSiblingIndex()):this.onButtonYes()},n.onNewGame=function(){console.log("确认开始？"),this.node.getChildByPath("startMenu/btNewNLoad/btNewGame/btYesONo").active=!0,this.node.getChildByPath("startMenu/btNewNLoad/btLoadGame/bars").active=!1},n.onButtonYes=function(){y.newGame(),h.preloadScene("myRoom"),console.log("开始新游戏"),console.log("播放myDream"),this.node.getChildByName("startMenu").active=!1,this.node.getChildByName("myDream").active=!0,this.node.getChildByName("btSkip").active=!0},n.onButtonNo=function(){console.log("取消开始"),this.node.getChildByPath("startMenu/btNewNLoad/btNewGame/btYesONo").active=!1},o}(c))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/hotelStore.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts"],(function(e){"use strict";var o,t,n,i,s,l,r,a,h,c,g,u,p,d,m,y,C,f,B;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.defineProperty,i=e.assertThisInitialized,s=e.initializerDefineProperty},function(e){l=e.cclegacy,r=e._decorator,a=e.Prefab,h=e.instantiate,c=e.Button,g=e.Collider2D,u=e.Contact2DType,p=e.director,d=e.tween,m=e.Vec3,y=e.Animation,C=e.Component},function(e){f=e.Controller},function(e){B=e.GlobalFunc}],execute:function(){var v,P,S,x,N;l._RF.push({},"b2090JLKvNI3q173vJAWd0M","hotelStore",void 0);var b=r.ccclass,R=r.property;e("hotelStore",(v=b("hotelStore"),P=R(a),v((N=o((x=function(e){function o(){for(var o,t=arguments.length,l=new Array(t),r=0;r<t;r++)l[r]=arguments[r];return o=e.call.apply(e,[this].concat(l))||this,n(i(o),"searchRes",[null,null]),n(i(o),"hero",null),n(i(o),"map",null),n(i(o),"jumpflag",0),n(i(o),"talksCount",99),n(i(o),"sceneTalks",[]),s(i(o),"dialogueBox",N,i(o)),o}t(o,e);var l=o.prototype;return l.onLoad=function(){console.log("未读取前进度："+B.ongoing.progress),B.ongoing.readLocal(),console.log("读取后进度："+B.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("map"),this.layoutGameProgress(),this.setEntryPos(),console.log("hotelKitchen所有对话："),console.log(B.sceneTalks);var e=h(this.dialogueBox);this.hero.addChild(e),e.active=!1,console.log(e.name+"加载成功"),console.log("现在对话数="+this.talksCount)},l.start=function(){this.hero.getChildByName("dialogueBox").on(c.EventType.CLICK,this.onNextSpeak,this);var e=this.node.getChildByPath("map/entry0").getComponent(g);e&&e.on(u.BEGIN_CONTACT,this.onEntry0,this)},l.onNextSpeak=function(){var e=this;this.hero.getChildByName("dialogueBox").getComponent(c).interactable=!1,this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0,this.scheduleOnce((function(){e.hero.getChildByName("dialogueBox").getComponent(c).interactable=!0}),1)},l.layoutGameProgress=function(){},l.setEntryPos=function(){console.log("进入 "+B.ongoing.nextSceneEntryPos+" 口"),0==B.ongoing.nextSceneEntryPos&&this.map.setPosition(482,344,0),1==B.ongoing.nextSceneEntryPos&&(this.map.setPosition(78.663,-428.939,0),this.jumpflag=1)},l.onEntry0=function(e,o,t){B.whichEntry("heroLXY",o,e,3,p.getScene().name,"hotel")},l.update=function(e){var o=this;this.searchRes=this.node.getChildByName("heroLXY").getComponent(f).onGetSearchRes(),null!=this.searchRes[0]&&(console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&"entry1"==this.searchRes[1].node.name&&(this.node.getChildByPath("map/collider").active=!1,d(this.hero).by(5,{position:new m(0,338,0)},{onStart:function(){o.hero.getComponent(y).play("climb")},onComplete:function(){o.hero.getComponent(y).stop(),B.ongoing.nextSceneEntryPos=1,B.ongoing.saveLocal(),p.loadScene("myRoom")}}).start(),console.log(this.searchRes[1].node.name),this.searchRes[1]=null),1==this.jumpflag&&(this.node.getChildByPath("map/collider").active=!1,d(this.hero).by(1,{position:new m(0,-176,0)},{onStart:function(){o.hero.getComponent(y).play("jump")},onComplete:function(){o.schedule((function(){o.node.getChildByPath("map/collider").active=!0}),.5),o.hero.getComponent(y).stop()}}).start(),this.jumpflag=0)},o}(C)).prototype,"dialogueBox",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=x))||S));l._RF.pop()}}}));

System.register("chunks:///_virtual/IsXianWharf.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./ShowTalk.ts"],(function(e){"use strict";var t,o,n,s,i,a,l,r,h,c,g,u,y,d,p,C,m,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.defineProperty,s=e.assertThisInitialized,i=e.initializerDefineProperty},function(e){a=e.cclegacy,l=e._decorator,r=e.Prefab,h=e.TiledMap,c=e.director,g=e.instantiate,u=e.Button,y=e.Collider2D,d=e.Contact2DType,p=e.Component},function(e){C=e.Controller},function(e){m=e.GlobalFunc},function(e){f=e.ShowTalk}],execute:function(){var B,k,v,x,N;a._RF.push({},"bb3f2WtCKtGeZUIqC5oKPHf","IsXianWharf",void 0);var T=l.ccclass,P=l.property;e("IsXianWharf",(B=T("IsXianWharf"),k=P(r),B((N=t((x=function(e){function t(){for(var t,o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return t=e.call.apply(e,[this].concat(a))||this,n(s(t),"searchRes",[null,null]),n(s(t),"hero",null),n(s(t),"map",null),n(s(t),"entrypos",[]),n(s(t),"talksCount",99),i(s(t),"dialogueBox",N,s(t)),t}o(t,e);var a=t.prototype;return a.onLoad=function(){console.log("未读取前进度："+m.ongoing.progress),m.ongoing.readLocal(),console.log("读取后进度："+m.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("map"),this.entrypos=this.map.getComponent(h).getObjectGroup("entrypos").getObjects(),console.log(this.entrypos);for(var e=0;e<this.entrypos.length;e++){var t=this.entrypos[e];console.log(t.x,t.y)}this.layoutGameProgress(),this.setEntryPos(),m.getStorageTalks("wharf"),console.log(c.getScene().name+"所有对话："),console.log(m.sceneTalks);var o=g(this.dialogueBox);this.hero.addChild(o),o.active=!1,console.log(o.name+"加载成功"),console.log("现在对话数="+this.talksCount)},a.start=function(){c.preloadScene("IsXianValley"),this.hero.getChildByName("dialogueBox").on(u.EventType.CLICK,this.onNextSpeak,this);var e=this.node.getChildByPath("map/entry0").getComponent(y);e&&e.on(d.BEGIN_CONTACT,this.onEntry0,this),15==m.ongoing.progress&&(this.talksCount=0,this.hero.getChildByName("dialogueBox").active=!0,this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1,f.haveTalks(this.hero.getChildByName("dialogueBox"),m.sceneTalks[this.talksCount]),this.talksCount++)},a.onNextSpeak=function(){var e=this;this.hero.getChildByName("dialogueBox").getComponent(u).interactable=!1,this.talksCount<m.sceneTalks.length?(console.log("当前第"+this.talksCount+"句，共"+m.sceneTalks.length+"句"),console.log(m.sceneTalks[this.talksCount].msg),f.haveTalks(this.hero.getChildByName("dialogueBox"),m.sceneTalks[this.talksCount]),this.talksCount++):(console.log("没有对话"),m.ongoing.progress++,this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0),this.scheduleOnce((function(){e.hero.getChildByName("dialogueBox").getComponent(u).interactable=!0}),1)},a.layoutGameProgress=function(){},a.setEntryPos=function(){console.log("进入 "+m.ongoing.nextSceneEntryPos+" 口"),this.hero.setPosition(3.5*(this.entrypos[m.ongoing.nextSceneEntryPos].x-1032),3.5*(1048-this.entrypos[m.ongoing.nextSceneEntryPos].offset.y),0)},a.onEntry0=function(e,t,o){m.whichEntry("heroLXY",t,e,1,c.getScene().name,"IsXianValley")},a.onEntry1=function(e,t,o){m.whichEntry("heroLXY",t,e,2,c.getScene().name,"villageMarket")},a.update=function(e){this.searchRes=this.node.getChildByName("heroLXY").getComponent(C).onGetSearchRes(),null!=this.searchRes[0]&&(console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&(console.log(this.searchRes[1].node.name),this.searchRes[1]=null)},t}(p)).prototype,"dialogueBox",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=x))||v));a._RF.pop()}}}));

System.register("chunks:///_virtual/villageDrugs.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./Seller.ts","./MainMenu.ts"],(function(e){"use strict";var t,o,n,s,i,r,l,h,a,c,g,u,d,y;return{setters:[function(e){t=e.inheritsLoose,o=e.defineProperty,n=e.assertThisInitialized},function(e){s=e.cclegacy,i=e._decorator,r=e.TiledMap,l=e.Collider2D,h=e.Contact2DType,a=e.director,c=e.Component},function(e){g=e.Controller},function(e){u=e.GlobalFunc},function(e){d=e.Seller},function(e){y=e.MainMenu}],execute:function(){var p;s._RF.push({},"d01d0puo85FWqivizM15dsb","villageDrugs",void 0);var m=i.ccclass;i.property,e("villageDrugs",m("villageDrugs")(p=function(e){function s(){for(var t,s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i))||this,o(n(t),"searchRes",[null,null]),o(n(t),"hero",null),o(n(t),"map",null),o(n(t),"entrypos",[]),o(n(t),"currItemsIndex",[0,1,2,3,4]),o(n(t),"talksCount",99),t}t(s,e);var i=s.prototype;return i.onLoad=function(){console.log("未读取前进度："+u.ongoing.progress),u.ongoing.readLocal(),console.log("读取后进度："+u.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("map"),this.entrypos=this.map.getComponent(r).getObjectGroup("entrypos").getObjects(),console.log(this.entrypos);for(var e=0;e<this.entrypos.length;e++){var t=this.entrypos[e];console.log(t.x,t.y)}this.layoutGameProgress(),this.setEntryPos()},i.start=function(){var e=this.node.getChildByPath("map/entry").getComponent(l);e&&e.on(h.BEGIN_CONTACT,this.onEntry,this)},i.layoutGameProgress=function(){},i.setEntryPos=function(){console.log("进入 "+u.ongoing.nextSceneEntryPos+" 口"),this.hero.setPosition(3.5*(this.entrypos[u.ongoing.nextSceneEntryPos].x-1032),this.entrypos[u.ongoing.nextSceneEntryPos].y-70,0)},i.onEntry=function(e,t,o){u.whichEntry("heroLXY",t,e,4,a.getScene().name,"village")},i.onSellBoxExit=function(){this.node.getChildByName("sellBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0,console.log("现在包里有："),console.log(u.ongoing.bagItems),15==u.ongoing.progress&&(u.ongoing.addToBagItems(16),this.hero.getComponent(g).onFlashHint("得到："+this.hero.getChildByName("mainMenu").getComponent(y).items[16].name))},i.update=function(e){this.searchRes=this.node.getChildByName("heroLXY").getComponent(g).onGetSearchRes(),null!=this.searchRes[0]&&("npcDoctor"==this.searchRes[0].collider.node.name&&(this.node.getChildByName("sellBox").setPosition(this.hero.getPosition()),this.node.getChildByName("sellBox").getComponent(d).initLayout(this.currItemsIndex),this.node.getChildByName("sellBox").active=!0,this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1),console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&(console.log(this.searchRes[1].node.name),this.searchRes[1]=null)},s}(c))||p);s._RF.pop()}}}));

System.register("chunks:///_virtual/hotelRoom1.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./ShowTalk.ts"],(function(e){"use strict";var o,t,i,n,s,a,h,l,r,c,g,u,d,m,p,C,y;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.defineProperty,n=e.assertThisInitialized,s=e.initializerDefineProperty},function(e){a=e.cclegacy,h=e._decorator,l=e.Prefab,r=e.instantiate,c=e.Button,g=e.Collider2D,u=e.Contact2DType,d=e.director,m=e.Component},function(e){p=e.Controller},function(e){C=e.GlobalFunc},function(e){y=e.ShowTalk}],execute:function(){var f,B,v,N,R;a._RF.push({},"d13c7CuiORJo4wxhqC2wS4p","hotelRoom1",void 0);var x=h.ccclass,k=h.property;e("hotelRoom1",(f=x("hotelRoom1"),B=k(l),f((R=o((N=function(e){function o(){for(var o,t=arguments.length,a=new Array(t),h=0;h<t;h++)a[h]=arguments[h];return o=e.call.apply(e,[this].concat(a))||this,i(n(o),"searchRes",[null,null]),i(n(o),"hero",null),i(n(o),"map",null),i(n(o),"talksCount",99),s(n(o),"dialogueBox",R,n(o)),o}t(o,e);var a=o.prototype;return a.onLoad=function(){console.log("未读取前进度："+C.ongoing.progress),C.ongoing.readLocal(),console.log("读取后进度："+C.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("maphotelRoom1"),this.layoutGameProgress(),this.setEntryPos(),console.log("hotel所有对话："),console.log(C.sceneTalks);var e=r(this.dialogueBox);this.hero.addChild(e),e.active=!1,console.log(e.name+"加载成功"),console.log("现在对话数="+this.talksCount)},a.start=function(){this.hero.getChildByName("dialogueBox").on(c.EventType.CLICK,this.onNextSpeak,this);var e=this.node.getChildByPath("maphotelRoom1/entry").getComponent(g);e&&e.on(u.BEGIN_CONTACT,this.onEntry,this)},a.onNextSpeak=function(){var e=this;this.hero.getChildByName("dialogueBox").getComponent(c).interactable=!1,this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0,this.scheduleOnce((function(){e.hero.getChildByName("dialogueBox").getComponent(c).interactable=!0}),1)},a.layoutGameProgress=function(){var e=this;C.ongoing.progress>2&&C.ongoing.progress<10&&(this.node.getChildByName("miaoChief").active=!0,4==C.ongoing.progress&&(this.talksCount=18,this.schedule((function(){C.changeSp(e.node.getChildByName("miaoChief"),"standum")}),.1)))},a.setEntryPos=function(){console.log("进入 "+C.ongoing.nextSceneEntryPos+" 口"),0==C.ongoing.nextSceneEntryPos&&(this.map.setPosition(540,184,0),this.node.getChildByName("miaoChief").active&&this.node.getChildByName("miaoChief").setPosition(this.node.getChildByName("miaoChief").position.x+this.map.position.x,this.node.getChildByName("miaoChief").position.y+this.map.position.y))},a.onEntry=function(e,o,t){C.whichEntry("heroLXY",o,e,4,d.getScene().name,"hotel")},a.update=function(e){this.searchRes=this.hero.getComponent(p).onGetSearchRes(),null!=this.searchRes[0]&&("miaoChief"==this.searchRes[0].collider.node.name&&4==C.ongoing.progress&&(this.hero.getChildByName("dialogueBox").active=!0,this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1,y.haveTalks(this.hero.getChildByName("dialogueBox"),C.sceneTalks[this.talksCount]),this.talksCount++,C.ongoing.progress++),console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&(console.log(this.searchRes[1].node.name),this.searchRes[1]=null)},o}(m)).prototype,"dialogueBox",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=N))||v));a._RF.pop()}}}));

System.register("chunks:///_virtual/hotelKitchen.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./ShowTalk.ts"],(function(e){"use strict";var t,o,n,i,h,s,a,l,r,c,g,d,u,C,p,y,B;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.defineProperty,i=e.assertThisInitialized,h=e.initializerDefineProperty},function(e){s=e.cclegacy,a=e._decorator,l=e.Prefab,r=e.instantiate,c=e.Button,g=e.Collider2D,d=e.Contact2DType,u=e.director,C=e.Component},function(e){p=e.Controller},function(e){y=e.GlobalFunc},function(e){B=e.ShowTalk}],execute:function(){var m,v,L,P,k;s._RF.push({},"d3ea1BK7ZlIEZbwy56ugz0J","hotelKitchen",void 0);var f=a.ccclass,N=a.property;e("hotelKitchen",(m=f("hotelKitchen"),v=N(l),m((k=t((P=function(e){function t(){for(var t,o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t=e.call.apply(e,[this].concat(s))||this,n(i(t),"searchRes",[null,null]),n(i(t),"hero",null),n(i(t),"map",null),n(i(t),"talksCount",99),h(i(t),"dialogueBox",k,i(t)),t}o(t,e);var s=t.prototype;return s.onLoad=function(){console.log("未读取前进度："+y.ongoing.progress),y.ongoing.readLocal(),console.log("读取后进度："+y.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("maphotelKitchen"),this.layoutGameProgress(),this.setEntryPos(),console.log("hotel所有对话："),console.log(y.sceneTalks);var e=r(this.dialogueBox);this.node.getChildByName("heroLXY").addChild(e),e.active=!1,console.log(e.name+"加载成功"),console.log("现在对话计数="+this.talksCount)},s.start=function(){this.hero.getChildByName("dialogueBox").on(c.EventType.CLICK,this.onNextSpeak,this);var e=this.node.getChildByPath("maphotelKitchen/entry").getComponent(g);e&&e.on(d.BEGIN_CONTACT,this.onEntry,this)},s.onNextSpeak=function(){var e=this;this.hero.getChildByName("dialogueBox").getComponent(c).interactable=!1,this.talksCount>39&&this.talksCount<45?(41==this.talksCount&&(console.log("得到50文。"),y.ongoing.coins+=50,this.hero.getComponent(p).onFlashHint("得到 50 文钱")),console.log("当前第"+this.talksCount+"句，共"+y.sceneTalks.length+"句"),console.log(y.sceneTalks[this.talksCount].msg),B.haveTalks(this.hero.getChildByName("dialogueBox"),y.sceneTalks[this.talksCount]),this.talksCount++):(this.node.getChildByPath("heroLXY/dialogueBox").active=!1,this.node.getChildByPath("heroLXY/ctrller").active=!0,this.node.getChildByPath("heroLXY/hand").active=!0),this.scheduleOnce((function(){e.hero.getChildByName("dialogueBox").getComponent(c).interactable=!0}),1)},s.layoutGameProgress=function(){y.ongoing.progress>2&&y.ongoing.progress<12?3==y.ongoing.progress?this.talksCount=16:(7==y.ongoing.progress&&(this.talksCount=40),this.node.getChildByPath("maphotelKitchen/dish").active=!1):(this.node.getChildByName("npcLDN").active=!1,this.node.getChildByPath("maphotelKitchen/dish").active=!1)},s.setEntryPos=function(){console.log("进入 "+y.ongoing.nextSceneEntryPos+" 口"),0==y.ongoing.nextSceneEntryPos&&(this.map.setPosition(-8,404,0),this.node.getChildByName("npcLDN").active&&this.node.getChildByName("npcLDN").setPosition(this.node.getChildByName("npcLDN").position.x+this.map.position.x,this.node.getChildByName("npcLDN").position.y+this.map.position.y))},s.onEntry=function(e,t,o){y.whichEntry("heroLXY",t,e,1,u.getScene().name,"hotel")},s.update=function(e){var t=this;this.searchRes=this.node.getChildByName("heroLXY").getComponent(p).onGetSearchRes(),null!=this.searchRes[0]&&("npcLDN"==this.searchRes[0].collider.node.name&&3==y.ongoing.progress&&(this.node.getChildByPath("heroLXY/dialogueBox").active=!0,this.node.getChildByPath("heroLXY/ctrller").active=!1,this.node.getChildByPath("heroLXY/hand").active=!1,B.haveTalks(this.node.getChildByPath("heroLXY/dialogueBox"),y.sceneTalks[this.talksCount]),this.talksCount++,y.ongoing.progress++),"npcLDN"==this.searchRes[0].collider.node.name&&7==y.ongoing.progress&&(this.node.getChildByPath("heroLXY/dialogueBox").active=!0,this.node.getChildByPath("heroLXY/ctrller").active=!1,this.node.getChildByPath("heroLXY/hand").active=!1,B.haveTalks(this.node.getChildByPath("heroLXY/dialogueBox"),y.sceneTalks[this.talksCount]),this.talksCount++,y.ongoing.progress++),console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&("dish"==this.searchRes[1].node.name&&4==y.ongoing.progress&&(this.node.getChildByPath("heroLXY/dialogueBox").active=!0,this.node.getChildByPath("heroLXY/ctrller").active=!1,this.node.getChildByPath("heroLXY/hand").active=!1,B.haveTalks(this.node.getChildByPath("heroLXY/dialogueBox"),y.sceneTalks[this.talksCount]),this.talksCount++,this.schedule((function(){t.node.getChildByPath("heroLXY/dialogueBox").active=!1,t.node.getChildByPath("heroLXY/ctrller").active=!0,t.node.getChildByPath("heroLXY/hand").active=!0}),.99),this.node.getChildByPath("maphotelKitchen/dish").active=!1,y.changeSp(this.hero,"serveDish")),console.log(this.searchRes[1].node.name),this.searchRes[1]=null)},t}(C)).prototype,"dialogueBox",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=P))||L));s._RF.pop()}}}));

System.register("chunks:///_virtual/NpcControl.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var i,o,n,e,r,s,l,h,p,c,a;return{setters:[function(t){i=t.applyDecoratedDescriptor,o=t.inheritsLoose,n=t.defineProperty,e=t.assertThisInitialized,r=t.initializerDefineProperty},function(t){s=t.cclegacy,l=t._decorator,h=t.Vec3,p=t.tween,c=t.Animation,a=t.Component}],execute:function(){var u,d,y,g,v,f,m,M;s._RF.push({},"d5176p1pIZDBZHwRC5YI2mI","NpcControl",void 0);var A=l.ccclass,P=l.property;t("NpcControl",(u=A("NpcControl"),d=P(h),y=P(h),u((f=i((v=function(t){function i(){for(var i,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return i=t.call.apply(t,[this].concat(s))||this,n(e(i),"deltaTimeCount",0),n(e(i),"dirX",0),n(e(i),"dirY",0),r(e(i),"npcSpeed",f,e(i)),r(e(i),"getMoveBy",m,e(i)),r(e(i),"getMoveTo",M,e(i)),i}o(i,t);var s=i.prototype;return s.start=function(){},s.npcMoveBy=function(){var t=this;p(this.node).by(1,{position:this.getMoveBy},{onComplete:function(){t.onStopAnim()}}).start()},s.npcMoveTo=function(){var t=this;p(this.node).to(1,{position:this.getMoveTo},{onComplete:function(){t.onStopAnim()}}).start()},s.onPlayAnim=function(t){this.node.getComponent(c).play(t)},s.onStopAnim=function(){this.node.getComponent(c).stop()},s.update=function(t){null!=this.getMoveBy&&(this.npcMoveBy(),console.log("npc相对移动"),this.dirX=this.getMoveBy.x,this.dirY=this.getMoveBy.y,this.dirX>0&&this.dirY>0&&this.onPlayAnim("up"),this.dirX>0&&this.dirY<0&&this.onPlayAnim("right"),this.dirX<0&&this.dirY>0&&this.onPlayAnim("left"),this.dirX<0&&this.dirY<0&&this.onPlayAnim("down"),this.getMoveBy=null),null!=this.getMoveTo&&(this.npcMoveTo(),console.log("npc走到指定点"),this.dirX=this.getMoveTo.x-this.node.position.x,this.dirY=this.getMoveTo.y-this.node.position.y,this.dirX>0&&this.dirY>0&&this.onPlayAnim("up"),this.dirX>0&&this.dirY<0&&this.onPlayAnim("right"),this.dirX<0&&this.dirY>0&&this.onPlayAnim("left"),this.dirX<0&&this.dirY<0&&this.onPlayAnim("down"),this.getMoveTo=null)},i}(a)).prototype,"npcSpeed",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=i(v.prototype,"getMoveBy",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=i(v.prototype,"getMoveTo",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=v))||g));s._RF.pop()}}}));

System.register("chunks:///_virtual/GameProgress.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,s,n,o,r,a,i,c,g,l;return{setters:[function(e){t=e.inheritsLoose,s=e.defineProperty,n=e.assertThisInitialized,o=e.createClass},function(e){r=e.cclegacy,a=e._decorator,i=e.Vec3,c=e.find,g=e.sys,l=e.Component}],execute:function(){var u;r._RF.push({},"dc6d4VHXpJKx7GqRz7TrTPC","GameProgress",void 0);var h=a.ccclass;a.property,e("GameProgress",h("GameProgress")(u=function(e){function r(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,s(n(t),"_progress",0),s(n(t),"_nextSceneEntryPos",0),s(n(t),"_coins",0),s(n(t),"savedCount",0),s(n(t),"currBGM",""),s(n(t),"bgmFlag",!0),s(n(t),"lastPos",new i(0,0,0)),s(n(t),"lastScene",""),s(n(t),"killedEnemies",[]),s(n(t),"heroactive",[1,0,0,0]),s(n(t),"herolevel",[0,0,0,0]),s(n(t),"herostate",[150,100]),s(n(t),"herocurrstate",[90,70]),s(n(t),"bagItems",[]),s(n(t),"currMagics",[0]),t}t(r,e);var a=r.prototype;return a.saveLocal=function(){this.lastScene=c("Canvas").parent.name,console.log(this.bagItems);var e=JSON.stringify(this);console.log(e),g.localStorage.setItem("ongoing",e)},a.readLocal=function(){console.log(g.localStorage.getItem("ongoing")),Object.assign(this,JSON.parse(g.localStorage.getItem("ongoing")))},a.saveGame=function(){},a.addToBagItems=function(e){var t=new Map(this.bagItems);t.has(e)?t.set(e,t.get(e)+1):t.set(e,1),this.bagItems=Array.from(t),console.log(this.bagItems)},a.hasBagItem=function(e){return!!new Map(this.bagItems).has(e)},a.getBagItem=function(e){return new Map(this.bagItems).get(e)},o(r,[{key:"progress",get:function(){return this._progress},set:function(e){this._progress=e<0?0:e,console.log("进度+1,现在="+this._progress)}},{key:"nextSceneEntryPos",get:function(){return this._nextSceneEntryPos},set:function(e){this._nextSceneEntryPos=e<0?0:e}},{key:"coins",get:function(){return this._coins},set:function(e){this._coins=e,console.log("现有金钱="+this._coins)}}]),r}(l))||u);r._RF.pop()}}}));

System.register("chunks:///_virtual/preGame.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,o,n,i,a,s;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,n=e._decorator,i=e.VideoPlayer,a=e.director,s=e.Component}],execute:function(){var r;o._RF.push({},"e894f7Abn9HA5Let75/2pus","preGame",void 0);var c=n.ccclass;n.property,e("preGame",c("preGame")(r=function(e){function o(){return e.apply(this,arguments)||this}t(o,e);var n=o.prototype;return n.start=function(){var e=this;this.node.getChildByName("softStar").once(i.EventType.READY_TO_PLAY,(function(){console.log(e.node.getChildByName("softStar").name+"开始播放"),e.node.getChildByName("softStar").getComponent(i).play()}),this),this.node.getChildByName("softStar").once(i.EventType.COMPLETED,(function(){console.log("播放完成"),e.node.getChildByName("softStar").getComponent(i).destroy(),e.node.getChildByName("btSkip").active=!1,console.log("切换starMenu场景"),a.loadScene("startMenu")}),this)},n.onStatement=function(){console.log("继续>>>"),this.node.getChildByName("statement").active=!1,this.node.getChildByName("softStar").active=!0,this.node.getChildByName("btSkip").active=!0},n.onSkip=function(){console.log("视频跳过！/视频播放完成！"),this.node.getChildByName("softStar").getComponent(i).destroy(),this.node.getChildByName("softStar").active=!1,this.node.getChildByName("btSkip").active=!1,console.log("切换starMenu场景"),a.loadScene("startMenu")},o}(s))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/hotel.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./ShowTalk.ts","./NpcControl.ts","./MainMenu.ts"],(function(t){"use strict";var e,o,n,i,s,h,a,l,g,d,r,c,p,C,m,y,u,B,N,k,T,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,n=t.defineProperty,i=t.assertThisInitialized,s=t.initializerDefineProperty},function(t){h=t.cclegacy,a=t._decorator,l=t.Prefab,g=t.instantiate,d=t.Button,r=t.Collider2D,c=t.Contact2DType,p=t.Vec3,C=t.Animation,m=t.UITransform,y=t.director,u=t.Component},function(t){B=t.Controller},function(t){N=t.GlobalFunc},function(t){k=t.ShowTalk},function(t){T=t.NpcControl},function(t){v=t.MainMenu}],execute:function(){var P,x,L,f,E;h._RF.push({},"f13d439mSNIgbPGeOTuMVJc","hotel",void 0);var S=a.ccclass,X=a.property;t("hotel",(P=S("hotel"),x=X(l),P((E=e((f=function(t){function e(){for(var e,o=arguments.length,h=new Array(o),a=0;a<o;a++)h[a]=arguments[a];return e=t.call.apply(t,[this].concat(h))||this,n(i(e),"searchRes",[null,null]),n(i(e),"hero",null),n(i(e),"map",null),n(i(e),"talksCount",99),n(i(e),"sceneTalks",[]),s(i(e),"dialogueBox",E,i(e)),e}o(e,t);var h=e.prototype;return h.onLoad=function(){var t=this;console.log("未读取前进度："+N.ongoing.progress),N.ongoing.readLocal(),console.log("读取后进度："+N.ongoing.progress),console.log(N.ongoing.bagItems),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("maphotel"),this.layoutGameProgress(),this.setEntryPos(),N.getStorageTalks("hotel"),console.log("hotel所有对话："),console.log(N.sceneTalks);var e=g(this.dialogueBox);this.node.getChildByName("heroLXY").addChild(e),e.active=!1,console.log(e.name+"加载成功"),1==N.ongoing.progress?(this.node.getChildByName("miao1").active=!0,this.node.getChildByName("miao2").active=!0,this.node.getChildByName("miaoChief").active=!0,this.node.getChildByName("npcLDN").active=!0,console.log("对话开始"),this.talksCount=0,this.schedule((function(){N.changeSp(t.node.getChildByName("npcLDN"),"standlldn")}),.2)):N.ongoing.progress>=2&&N.ongoing.progress<=6?console.log("其他进度"):this.node.getChildByName("npcTao").active=!1,console.log("现在对话计数="+this.talksCount)},h.start=function(){14==N.ongoing.progress?(this.talksCount=0,N.getStorageTalks("preIsXian"),console.log("preIsXian所有对话："),console.log(N.sceneTalks),this.hero.getChildByName("dialogueBox").on(d.EventType.CLICK,this.onNextSpeak1,this)):this.hero.getChildByName("dialogueBox").on(d.EventType.CLICK,this.onNextSpeak,this);var t=this.node.getChildByPath("maphotel/entry0").getComponent(r),e=this.node.getChildByPath("maphotel/entry1").getComponent(r),o=this.node.getChildByPath("maphotel/entry2").getComponent(r),n=this.node.getChildByPath("maphotel/entry3").getComponent(r),i=this.node.getChildByPath("maphotel/entry4").getComponent(r),s=this.node.getChildByPath("maphotel/entry5").getComponent(r),h=this.node.getChildByPath("maphotel/entry6").getComponent(r);t&&t.on(c.BEGIN_CONTACT,this.onEntry0,this),e&&e.on(c.BEGIN_CONTACT,this.onEntry1,this),o&&o.on(c.BEGIN_CONTACT,this.onEntry2,this),n&&n.on(c.BEGIN_CONTACT,this.onEntry3,this),i&&i.on(c.BEGIN_CONTACT,this.onEntry4,this),s&&s.on(c.BEGIN_CONTACT,this.onEntry5,this),h&&h.on(c.BEGIN_CONTACT,this.onEntry6,this)},h.onNextSpeak1=function(){var t=this;this.hero.getChildByName("dialogueBox").getComponent(d).interactable=!1,this.talksCount<N.sceneTalks.length?(console.log("当前第"+this.talksCount+"句，共"+N.sceneTalks.length+"句"),console.log(N.sceneTalks[this.talksCount].msg),k.haveTalks(this.hero.getChildByName("dialogueBox"),N.sceneTalks[this.talksCount]),this.talksCount++):(N.ongoing.addToBagItems(15),this.hero.getComponent(B).onFlashHint("得到："+this.hero.getChildByName("mainMenu").getComponent(v).items[15].name),this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0,N.ongoing.progress++,this.node.getChildByName("npcMiao").active=!1),this.scheduleOnce((function(){t.hero.getChildByName("dialogueBox").getComponent(d).interactable=!0}),1)},h.onNextSpeak=function(){var t=this;this.hero.getChildByName("dialogueBox").getComponent(d).interactable=!1,this.talksCount<10?(3==this.talksCount&&(this.node.getChildByName("npcLDN").getComponent(T).getMoveTo=new p(-1246,633)),4==this.talksCount&&(this.node.getChildByName("npcLDN").getComponent(T).getMoveTo=new p(-1450,531)),5==this.talksCount&&(this.node.getChildByName("npcLDN").getComponent(T).getMoveTo=new p(-1053,141)),6==this.talksCount&&(this.node.getChildByName("npcLDN").getComponent(T).getMoveTo=new p(-723,-26),this.node.getChildByPath("miao2").getComponent(T).getMoveBy=new p(80,40)),7==this.talksCount&&(this.node.getChildByName("npcLDN").getComponent(T).getMoveTo=new p(-1455,-392),this.node.getChildByPath("miao1").getComponent(T).getMoveTo=new p(-905,456),this.node.getChildByPath("miao2").getComponent(T).getMoveTo=new p(-840,384),this.schedule((function(){N.changeSp(t.node.getChildByName("npcLDN"),"standdldn")}),.2)),8==this.talksCount&&(this.node.getChildByPath("miaoChief").getComponent(T).getMoveBy=new p(158,95),this.schedule((function(){t.node.getChildByName("miaoChief").active=!1}),1),this.node.getChildByPath("miao1").getComponent(T).getMoveTo=new p(-552,275),this.node.getChildByPath("miao2").getComponent(T).getMoveTo=new p(-552,239)),9==this.talksCount&&(this.node.getChildByPath("miao1").getComponent(T).getMoveBy=new p(140,70),this.node.getChildByPath("miao2").getComponent(T).getMoveBy=new p(180,90),this.schedule((function(){t.node.getChildByName("miao1").active=!1,t.node.getChildByName("miao2").active=!1}),1),N.ongoing.progress++,N.ongoing.coins+=500,this.hero.getComponent(B).onFlashHint("得到 500 文钱"),console.log("当前进度："+N.ongoing.progress)),console.log("当前第"+this.talksCount+"句，共"+N.sceneTalks.length+"句"),console.log(N.sceneTalks[this.talksCount].msg),k.haveTalks(this.hero.getChildByName("dialogueBox"),N.sceneTalks[this.talksCount]),this.talksCount++):11==this.talksCount?(this.node.getChildByPath("heroLXY/dialogueBox").active=!1,this.node.getChildByPath("heroLXY/ctrller").active=!0,this.node.getChildByPath("heroLXY/hand").active=!0,this.node.getChildByName("npcLDN").getComponent(T).getMoveTo=new p(-2072,-84)):this.talksCount>11&&this.talksCount<16?(12==this.talksCount&&(this.node.getChildByName("npcLDN").getComponent(T).getMoveTo=new p(-1550,177)),13==this.talksCount&&(this.node.getChildByName("npcLDN").active=!1),15==this.talksCount&&(N.ongoing.progress++,console.log("当前进度："+N.ongoing.progress)),console.log("当前第"+this.talksCount+"句，共"+N.sceneTalks.length+"句"),console.log(N.sceneTalks[this.talksCount].msg),k.haveTalks(this.hero.getChildByName("dialogueBox"),N.sceneTalks[this.talksCount]),this.talksCount++):this.talksCount>26&&this.talksCount<40?(27==this.talksCount&&(this.node.getChildByName("npcTao").getComponent(C).stop(),this.node.getChildByName("npcTao").getComponent(m).setContentSize(19,50),this.schedule((function(){N.changeSp(t.node.getChildByName("npcTao"),"tao")}),.2)),37==this.talksCount&&(this.node.getChildByName("npcTao").active=!1),39==this.talksCount&&N.ongoing.progress++,console.log("当前第"+this.talksCount+"句，共"+N.sceneTalks.length+"句"),console.log(N.sceneTalks[this.talksCount].msg),k.haveTalks(this.hero.getChildByName("dialogueBox"),N.sceneTalks[this.talksCount]),this.talksCount++):(this.node.getChildByPath("heroLXY/dialogueBox").active=!1,this.node.getChildByPath("heroLXY/ctrller").active=!0,this.node.getChildByPath("heroLXY/hand").active=!0),this.scheduleOnce((function(){t.hero.getChildByName("dialogueBox").getComponent(d).interactable=!0}),1)},h.onEntry0=function(t,e,o){N.ongoing.progress>7&&N.whichEntry("heroLXY",e,t,0,y.getScene().name,"village")},h.onEntry1=function(t,e,o){N.ongoing.progress>2&&N.whichEntry("heroLXY",e,t,0,y.getScene().name,"hotelKitchen")},h.onEntry2=function(t,e,o){N.ongoing.progress>10&&N.whichEntry("heroLXY",e,t,0,y.getScene().name,"hotelRoom3")},h.onEntry3=function(t,e,o){N.ongoing.progress>7&&N.whichEntry("heroLXY",e,t,0,y.getScene().name,"hotelStore")},h.onEntry4=function(t,e,o){N.ongoing.progress>3&&N.whichEntry("heroLXY",e,t,0,y.getScene().name,"hotelRoom1")},h.onEntry5=function(t,e,o){N.ongoing.progress>3&&N.whichEntry("heroLXY",e,t,0,y.getScene().name,"hotelRoom2")},h.onEntry6=function(t,e,o){N.ongoing.progress>3&&N.whichEntry("heroLXY",e,t,0,y.getScene().name,"myRoom")},h.layoutGameProgress=function(){4==N.ongoing.progress?this.talksCount=18:5==N.ongoing.progress?this.talksCount=19:6==N.ongoing.progress&&(this.talksCount=26)},h.setEntryPos=function(){console.log("进入 "+N.ongoing.nextSceneEntryPos+" 口"),6==N.ongoing.nextSceneEntryPos?(this.map.setPosition(-1238,-118,0),1==N.ongoing.progress&&(this.node.getChildByName("miao1").setPosition(this.node.getChildByName("miao1").position.x+this.map.position.x,this.node.getChildByName("miao1").position.y+this.map.position.y),this.node.getChildByName("miao2").setPosition(this.node.getChildByName("miao2").position.x+this.map.position.x,this.node.getChildByName("miao2").position.y+this.map.position.y),this.node.getChildByName("miaoChief").setPosition(this.node.getChildByName("miaoChief").position.x+this.map.position.x,this.node.getChildByName("miaoChief").position.y+this.map.position.y),this.node.getChildByName("npcLDN").setPosition(this.node.getChildByName("npcLDN").position.x+this.map.position.x,this.node.getChildByName("npcLDN").position.y+this.map.position.y),this.node.getChildByName("npcTao").setPosition(this.node.getChildByName("npcTao").position.x+this.map.position.x,this.node.getChildByName("npcTao").position.y+this.map.position.y))):1==N.ongoing.nextSceneEntryPos?(this.map.setPosition(655,-175,0),N.ongoing.progress<=6&&this.node.getChildByName("npcTao").setPosition(this.node.getChildByName("npcTao").position.x+this.map.position.x,this.node.getChildByName("npcTao").position.y+this.map.position.y)):4==N.ongoing.nextSceneEntryPos?(this.map.setPosition(-144,-654,0),N.ongoing.progress<=6&&this.node.getChildByName("npcTao").setPosition(this.node.getChildByName("npcTao").position.x+this.map.position.x,this.node.getChildByName("npcTao").position.y+this.map.position.y)):5==N.ongoing.nextSceneEntryPos?(this.map.setPosition(-700,-378,0),N.ongoing.progress<=6&&this.node.getChildByName("npcTao").setPosition(this.node.getChildByName("npcTao").position.x+this.map.position.x,this.node.getChildByName("npcTao").position.y+this.map.position.y)):2==N.ongoing.nextSceneEntryPos?(this.map.setPosition(-265,-274,0),N.ongoing.progress<=6&&this.node.getChildByName("npcTao").setPosition(this.node.getChildByName("npcTao").position.x+this.map.position.x,this.node.getChildByName("npcTao").position.y+this.map.position.y),14==N.ongoing.progress&&(this.node.getChildByName("npcMiao").active=!0,this.node.getChildByName("npcMiao").setPosition(this.node.getChildByName("npcMiao").position.x+this.map.position.x,this.node.getChildByName("npcMiao").position.y+this.map.position.y))):3==N.ongoing.nextSceneEntryPos?(this.map.setPosition(-800,0,0),N.ongoing.progress<=6&&this.node.getChildByName("npcTao").setPosition(this.node.getChildByName("npcTao").position.x+this.map.position.x,this.node.getChildByName("npcTao").position.y+this.map.position.y)):0==N.ongoing.nextSceneEntryPos&&this.map.setPosition(610,466,0)},h.update=function(t){this.searchRes=this.node.getChildByName("heroLXY").getComponent(B).onGetSearchRes(),null!=this.searchRes[0]&&"npcLDN"==this.searchRes[0].collider.node.name?(0!=this.talksCount&&10!=this.talksCount||(this.node.getChildByPath("heroLXY/dialogueBox").active=!0,this.node.getChildByPath("heroLXY/ctrller").active=!1,this.node.getChildByPath("heroLXY/hand").active=!1,k.haveTalks(this.node.getChildByPath("heroLXY/dialogueBox"),N.sceneTalks[this.talksCount]),this.talksCount++),console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null):null!=this.searchRes[0]&&"npcTao"==this.searchRes[0].collider.node.name?((2==N.ongoing.progress&&11==this.talksCount||6==N.ongoing.progress&&26==this.talksCount)&&(this.node.getChildByPath("heroLXY/dialogueBox").active=!0,this.node.getChildByPath("heroLXY/ctrller").active=!1,this.node.getChildByPath("heroLXY/hand").active=!1,k.haveTalks(this.node.getChildByPath("heroLXY/dialogueBox"),N.sceneTalks[this.talksCount]),this.talksCount++),this.searchRes[0]=null):null!=this.searchRes[0]&&"npcMiao"==this.searchRes[0].collider.node.name&&(14==N.ongoing.progress&&(this.node.getChildByPath("heroLXY/dialogueBox").active=!0,this.node.getChildByPath("heroLXY/ctrller").active=!1,this.node.getChildByPath("heroLXY/hand").active=!1,k.haveTalks(this.node.getChildByPath("heroLXY/dialogueBox"),N.sceneTalks[this.talksCount]),this.talksCount++),console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&(console.log(this.searchRes[1].node.name),this.searchRes[1]=null)},e}(u)).prototype,"dialogueBox",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=f))||L));h._RF.pop()}}}));

System.register("chunks:///_virtual/village.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./GlobalFunc.ts","./ShowTalk.ts","./MainMenu.ts"],(function(t){"use strict";var e,o,n,i,s,a,l,h,g,r,c,u,d,C,m,y,p,k,B,v,N;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,n=t.defineProperty,i=t.assertThisInitialized,s=t.initializerDefineProperty},function(t){a=t.cclegacy,l=t._decorator,h=t.Prefab,g=t.TiledMap,r=t.director,c=t.instantiate,u=t.Button,d=t.Collider2D,C=t.Contact2DType,m=t.find,y=t.AudioSource,p=t.Component},function(t){k=t.Controller},function(t){B=t.GlobalFunc},function(t){v=t.ShowTalk},function(t){N=t.MainMenu}],execute:function(){var T,f,x,X,E;a._RF.push({},"f5dbdB/HEhDwpYV78KlZ0jb","village",void 0);var P=l.ccclass,b=l.property;t("village",(T=P("village"),f=b(h),T((E=e((X=function(t){function e(){for(var e,o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e=t.call.apply(t,[this].concat(a))||this,n(i(e),"searchRes",[null,null]),n(i(e),"hero",null),n(i(e),"map",null),n(i(e),"entrypos",[]),n(i(e),"talktoXiu",!1),n(i(e),"talktoXiang",!1),n(i(e),"talksCount",99),s(i(e),"dialogueBox",E,i(e)),e}o(e,t);var a=e.prototype;return a.onLoad=function(){console.log("未读取前进度："+B.ongoing.progress),B.ongoing.readLocal(),console.log("读取后进度："+B.ongoing.progress),this.hero=this.node.getChildByName("heroLXY"),this.map=this.node.getChildByName("map"),this.entrypos=this.map.getComponent(g).getObjectGroup("entrypos").getObjects(),console.log(this.entrypos);for(var t=0;t<this.entrypos.length;t++){var e=this.entrypos[t];console.log(e.x,e.y)}this.layoutGameProgress(),this.setEntryPos(),B.getStorageTalks("village"),console.log(r.getScene().name+"所有对话："),console.log(B.sceneTalks);var o=c(this.dialogueBox);this.hero.addChild(o),o.active=!1,console.log(o.name+"加载成功"),console.log("现在对话数="+this.talksCount)},a.start=function(){this.hero.getChildByName("dialogueBox").on(u.EventType.CLICK,this.onNextSpeak,this);var t=this.node.getChildByPath("map/entry0").getComponent(d);t&&t.on(C.BEGIN_CONTACT,this.onEntry0,this);var e=this.node.getChildByPath("map/entry1").getComponent(d);e&&e.on(C.BEGIN_CONTACT,this.onEntry1,this);var o=this.node.getChildByPath("map/onXiang").getComponent(d);o&&o.on(C.BEGIN_CONTACT,this.onXiang,this);var n=this.node.getChildByPath("map/entry4").getComponent(d);n&&n.on(C.BEGIN_CONTACT,this.onEntry4,this)},a.onNextSpeak=function(){var t=this;this.hero.getChildByName("dialogueBox").getComponent(u).interactable=!1,this.talksCount<4||this.talksCount>=7&&this.talksCount<10&&this.talktoXiang?(console.log("当前第"+this.talksCount+"句，共"+B.sceneTalks.length+"句"),console.log(B.sceneTalks[this.talksCount].msg),v.haveTalks(this.hero.getChildByName("dialogueBox"),B.sceneTalks[this.talksCount]),this.talksCount++):4==this.talksCount&&0==this.talktoXiu?(this.talktoXiu=!0,B.ongoing.progress++,this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0):this.talktoXiu&&this.talksCount>3&&this.talksCount<7?(console.log("当前第"+this.talksCount+"句，共"+B.sceneTalks.length+"句"),console.log(B.sceneTalks[this.talksCount].msg),v.haveTalks(this.hero.getChildByName("dialogueBox"),B.sceneTalks[this.talksCount]),this.talksCount++):7==this.talksCount&&0==this.talktoXiang?(this.talktoXiang=!0,B.ongoing.progress++,this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0):10==this.talksCount?(B.ongoing.progress++,B.ongoing.addToBagItems(8),this.hero.getComponent(k).onFlashHint("得到："+this.hero.getChildByName("mainMenu").getComponent(N).items[8].name),this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0):this.talksCount>10&&this.talksCount<B.sceneTalks.length?(this.talksCount==B.sceneTalks.length-1&&(B.ongoing.progress++,this.node.getChildByPath("map/onXiang").active=!1,B.changeBGM("bgmLdnIlled",m("bgm").getComponent(y))),console.log("当前第"+this.talksCount+"句，共"+B.sceneTalks.length+"句"),console.log(B.sceneTalks[this.talksCount].msg),v.haveTalks(this.hero.getChildByName("dialogueBox"),B.sceneTalks[this.talksCount]),this.talksCount++):(console.log("没有对话"),this.hero.getChildByName("dialogueBox").active=!1,this.hero.getChildByName("ctrller").active=!0,this.hero.getChildByName("hand").active=!0),this.scheduleOnce((function(){t.hero.getChildByName("dialogueBox").getComponent(u).interactable=!0}),1)},a.layoutGameProgress=function(){8==B.ongoing.progress&&(this.talksCount=0,B.changeBGM("bgmVillage",m("bgm").getComponent(y))),9==B.ongoing.progress&&(this.talksCount=4,this.talktoXiu=!0),10==B.ongoing.progress&&(this.talksCount=7,this.talktoXiu=!0,this.talktoXiang=!0),12==B.ongoing.progress&&(this.node.getChildByPath("map/onXiang").active=!0,this.node.getChildByName("npcXiang").setPosition(2265,-1223,0),this.talksCount=11),B.ongoing.progress>=15&&(this.node.getChildByPath("map/entry4").active=!0)},a.setEntryPos=function(){console.log("进入 "+B.ongoing.nextSceneEntryPos+" 口"),this.hero.setPosition(3.5*(this.entrypos[B.ongoing.nextSceneEntryPos].x-1040),3.5*this.entrypos[B.ongoing.nextSceneEntryPos].y,0)},a.onXiang=function(){this.hero.getComponent(k).onStop(),this.hero.getChildByName("dialogueBox").active=!0,this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1,v.haveTalks(this.hero.getChildByName("dialogueBox"),B.sceneTalks[this.talksCount]),this.talksCount++},a.onEntry0=function(t,e,o){B.whichEntry("heroLXY",e,t,0,r.getScene().name,"hotel")},a.onEntry1=function(t,e,o){B.whichEntry("heroLXY",e,t,3,r.getScene().name,"villageMarket")},a.onEntry4=function(t,e,o){B.whichEntry("heroLXY",e,t,0,r.getScene().name,"villageDrugs")},a.update=function(t){this.searchRes=this.node.getChildByName("heroLXY").getComponent(k).onGetSearchRes(),null!=this.searchRes[0]&&("npcXiu"==this.searchRes[0].collider.node.name?8!=B.ongoing.progress&&10!=B.ongoing.progress||(this.talktoXiang&&(this.talksCount=7),this.hero.getChildByName("dialogueBox").active=!0,this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1,v.haveTalks(this.hero.getChildByName("dialogueBox"),B.sceneTalks[this.talksCount]),this.talksCount++):"npcXiang"==this.searchRes[0].collider.node.name&&9==B.ongoing.progress&&(this.hero.getChildByName("dialogueBox").active=!0,this.hero.getChildByName("ctrller").active=!1,this.hero.getChildByName("hand").active=!1,v.haveTalks(this.hero.getChildByName("dialogueBox"),B.sceneTalks[this.talksCount]),this.talksCount++),console.log(this.searchRes[0].collider.node.name),this.searchRes[0]=null),null!=this.searchRes[1]&&(console.log(this.searchRes[1].node.name),this.searchRes[1]=null)},e}(p)).prototype,"dialogueBox",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=X))||x));a._RF.pop()}}}));

System.register("chunks:///_virtual/battlefield.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./GlobalFunc.ts"],(function(t){"use strict";var e,n,o,i,r,a,l,s,c,g,h;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,i=t.Button,r=t.Label,a=t.resources,l=t.SpriteFrame,s=t.Sprite,c=t.director,g=t.Component},function(t){h=t.GlobalFunc}],execute:function(){var u;n._RF.push({},"f5f5aemzhVBVoioogdt5LrP","battlefield",void 0);var p=o.ccclass;o.property,t("battlefield",p("battlefield")(u=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var o=n.prototype;return o.start=function(){this.node.getChildByName("win").once(i.EventType.CLICK,this.winBattle,this),this.initData()},o.initData=function(){var t=this;this.node.getChildByPath("brief/hpall").getComponent(r).string=String(h.ongoing.herostate[0]),this.node.getChildByPath("brief/mpall").getComponent(r).string=String(h.ongoing.herostate[1]),this.node.getChildByPath("brief/hpcurr").getComponent(r).string=String(h.ongoing.herocurrstate[0]),this.node.getChildByPath("brief/mpcurr").getComponent(r).string=String(h.ongoing.herocurrstate[1]),a.load("battle/briefAvatar/spriteFrame",l,(function(e,n){t.node.getChildByPath("brief/avatar").getComponent(s).spriteFrame=n}))},o.loseGame=function(){console.log("输了")},o.winBattle=function(){console.log("winwinwin要返回了"),console.log(h.ongoing.lastScene),console.log("egreen挂了"),c.loadScene(h.ongoing.lastScene)},n}(g))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Controller.ts","./GameProgress.ts","./GlobalFunc.ts","./ShowTalk.ts","./hotelRoom2.ts","./EnemyControl.ts","./dialtype.ts","./hotelRoom3.ts","./Seller.ts","./villageWeapns.ts","./sellitemtype.ts","./NpcControl.ts","./villageMarket.ts","./MainMenu.ts","./myRoom.ts","./IsXianValley.ts","./startMenu.ts","./hotelStore.ts","./IsXianWharf.ts","./villageDrugs.ts","./hotelRoom1.ts","./hotelKitchen.ts","./preGame.ts","./hotel.ts","./village.ts","./battlefield.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=index.js.map